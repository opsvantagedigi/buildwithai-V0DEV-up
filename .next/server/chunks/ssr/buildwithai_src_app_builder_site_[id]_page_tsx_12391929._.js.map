{"version":3,"sources":["../../../../../buildwithai/src/app/builder/site/%5Bid%5D/page.tsx","../../../../../buildwithai/src/components/builder/BlockRenderer.tsx","../../../../../buildwithai/src/components/marketing/SocialProof.tsx","../../../../../buildwithai/src/components/builder/PageNavigator.tsx","../../../../../buildwithai/src/components/builder/Canvas.tsx","../../../../../buildwithai/src/components/builder/Sidebar.tsx","../../../../../buildwithai/src/components/builder/editors/ImageField.tsx","../../../../../buildwithai/src/components/builder/editors/TextField.tsx","../../../../../buildwithai/src/components/builder/editors/FeatureListEditor.tsx","../../../../../buildwithai/src/components/builder/editors/FAQEditor.tsx","../../../../../buildwithai/src/components/builder/editors/TestimonialEditor.tsx","../../../../../buildwithai/src/components/builder/editors/ToneSelector.tsx","../../../../../buildwithai/src/components/builder/editors/AIRewriteButton.tsx","../../../../../buildwithai/src/components/builder/BlockEditorSidebar.tsx","../../../../../buildwithai/src/lib/kv.ts","../../../../../buildwithai/src/lib/builder/load.ts","../../../../../buildwithai/src/lib/builder/save.ts","../../../../../buildwithai/src/lib/sites/registry.ts","../../../../../buildwithai/src/lib/sites/getSite.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useParams } from \"next/navigation\";\r\nimport Canvas from \"@/components/builder/Canvas\";\r\nimport { Sidebar } from \"@/components/builder/Sidebar\";\r\nimport BlockEditorSidebar from \"@/components/builder/BlockEditorSidebar\";\r\nimport { loadSiteState } from \"@/lib/builder/load\";\r\nimport { saveSiteState } from \"../../../../lib/builder/save\";\r\nimport { registerSite, updateSiteTimestamp } from \"@/lib/sites/registry\";\r\nimport { getSite } from \"../../../../lib/sites/getSite\";\r\nimport type { PublishMetadata } from \"@/types/publish\";\r\nimport type { PublishHistoryEntry, PublishHistory } from \"@/types/publish\";\r\nimport type { BuilderState } from \"@/types/builder\";\r\n\r\ntype Props = { params: { id: string } };\r\n\r\nexport default function BuilderCanvas({ params }: Props) {\r\n  const siteId = params.id;\r\n\r\n  const [state, setState] = useState<BuilderState | null>(null);\r\n  const [selectedBlockId, setSelectedBlockId] = useState<string | null>(null);\r\n  const [isPublishing, setIsPublishing] = useState(false);\r\n  const [publishMetadata, setPublishMetadata] =\r\n    useState<PublishMetadata | null>(null);\r\n  const [publishError, setPublishError] = useState<string | null>(null);\r\n  const [publishHistory, setPublishHistory] = useState<\r\n    PublishHistoryEntry[] | null\r\n  >(null);\r\n  const [showHistory, setShowHistory] = useState(false);\r\n  const [isRestoring, setIsRestoring] = useState(false);\r\n  const [restoreError, setRestoreError] = useState<string | null>(null);\r\n  const [isPreviewing, setIsPreviewing] = useState(false);\r\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null);\r\n  const [isStaging, setIsStaging] = useState(false);\r\n  const [stagingUrl, setStagingUrl] = useState<string | null>(null);\r\n  const [stagingError, setStagingError] = useState<string | null>(null);\r\n  const [promoting, setPromoting] = useState(false);\r\n  const [site, setSite] = useState<{ id: string; name: string; createdAt: number; updatedAt: number } | null>(null);\r\n  const [expandedChangelogVersion, setExpandedChangelogVersion] = useState<\r\n    number | null\r\n  >(null);\r\n  const [changelogContent, setChangelogContent] = useState<\r\n    Record<number, string | null>\r\n  >({});\r\n  const [expandedReleaseNotesVersion, setExpandedReleaseNotesVersion] = useState<number | null>(null);\r\n  const [releaseNotesContent, setReleaseNotesContent] = useState<Record<number, string | null>>({});\r\n\r\n  useEffect(() => {\r\n    async function init() {\r\n      const kvState = await loadSiteState(siteId);\r\n      if (kvState) {\r\n        setState(kvState);\r\n        return;\r\n      }\r\n\r\n      const raw = localStorage.getItem(`buildwithai:site:${siteId}`);\r\n      if (raw) {\r\n        try {\r\n          const parsed = JSON.parse(raw);\r\n          const initial: BuilderState = {\r\n            metadata: {\r\n              id: siteId,\r\n              name: parsed?.metadata?.name ?? \"Untitled\",\r\n              createdAt: parsed?.metadata?.createdAt ?? Date.now(),\r\n              updatedAt: parsed?.metadata?.updatedAt ?? Date.now(),\r\n              version: parsed?.metadata?.version ?? 1,\r\n            },\r\n            pages:\r\n              parsed.pages ?? [{ id: \"page-1\", title: \"Home\", slug: \"/\", blocks: [] }],\r\n            activePageId: parsed.activePageId ?? \"page-1\",\r\n          };\r\n\r\n          setState(initial);\r\n\r\n          // Save to KV immediately\r\n          await saveSiteState(siteId, initial);\r\n        } catch (e) {\r\n          // ignore\r\n        }\r\n      }\r\n    }\r\n\r\n    init();\r\n  }, [siteId]);\r\n\r\n  useEffect(() => {\r\n    async function load() {\r\n      const data = await getSite(siteId);\r\n      setSite(data);\r\n\r\n      // Auto-register site in dashboard registry\r\n      if (data?.name) {\r\n        await registerSite(siteId, data.name);\r\n        await updateSiteTimestamp(siteId);\r\n      }\r\n    }\r\n    load();\r\n  }, [siteId]);\r\n\r\n  // AUTOSAVE (debounced)\r\n  useEffect(() => {\r\n    if (!state?.metadata) return;\r\n\r\n    const timeout = setTimeout(() => {\r\n      saveSiteState(siteId, state);\r\n    }, 500);\r\n\r\n    return () => clearTimeout(timeout);\r\n  }, [state, siteId]);\r\n\r\n  async function handlePublish() {\r\n    if (!state) return;\r\n    setIsPublishing(true);\r\n    setPublishError(null);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/publish\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ siteId }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const data = await res.json().catch(() => ({}));\r\n        setPublishError(\r\n          data?.error ?? `Publish failed with status ${res.status}`\r\n        );\r\n        setIsPublishing(false);\r\n        return;\r\n      }\r\n\r\n      const data = await res.json();\r\n      if (data?.publish) {\r\n        setPublishMetadata(data.publish as PublishMetadata);\r\n      }\r\n\r\n      if (data?.history) {\r\n        setPublishHistory(data.history);\r\n      }\r\n    } catch (error: any) {\r\n      setPublishError(error?.message ?? \"Unexpected error during publish\");\r\n    } finally {\r\n      setIsPublishing(false);\r\n    }\r\n  }\r\n\r\n  async function handlePreview() {\r\n    setIsPreviewing(true);\r\n    setPreviewUrl(null);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/publish/preview\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ siteId }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (data?.previewUrl) {\r\n        setPreviewUrl(data.previewUrl);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Preview error\", error);\r\n    } finally {\r\n      setIsPreviewing(false);\r\n    }\r\n  }\r\n\r\n  async function handleStaging() {\r\n    setIsStaging(true);\r\n    setStagingUrl(null);\r\n    setStagingError(null);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/publish/staging\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ siteId }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!res.ok) {\r\n        setStagingError(data?.error ?? \"Staging deploy failed\");\r\n        setIsStaging(false);\r\n        return;\r\n      }\r\n\r\n      if (data?.stagingUrl) {\r\n        setStagingUrl(data.stagingUrl);\r\n      }\r\n    } catch (error: any) {\r\n      setStagingError(error?.message ?? \"Unexpected staging error\");\r\n    } finally {\r\n      setIsStaging(false);\r\n    }\r\n  }\r\n\r\n  async function loadHistory() {\r\n    const res = await fetch(`/api/publish/history?siteId=${siteId}`);\r\n    if (!res.ok) return;\r\n    const data = await res.json();\r\n    if (data?.history) setPublishHistory(data.history);\r\n  }\r\n\r\n  async function handleRestore(version: number) {\r\n    setIsRestoring(true);\r\n    setRestoreError(null);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/publish/rollback\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ siteId, version }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const data = await res.json().catch(() => ({}));\r\n        setRestoreError(\r\n          data?.error ?? `Restore failed with status ${res.status}`\r\n        );\r\n        setIsRestoring(false);\r\n        return;\r\n      }\r\n\r\n      // Reload page to reflect restored state\r\n      window.location.reload();\r\n    } catch (error: any) {\r\n      setRestoreError(error?.message ?? \"Unexpected restore error\");\r\n    } finally {\r\n      setIsRestoring(false);\r\n    }\r\n  }\r\n\r\n  async function loadChangelog(version: number) {\r\n    // Return cached if present\r\n    if (changelogContent[version] !== undefined) return;\r\n\r\n    const res = await fetch(\r\n      `/api/publish/changelog?siteId=${siteId}&version=${version}`\r\n    );\r\n    if (!res.ok) {\r\n      setChangelogContent((prev) => ({\r\n        ...prev,\r\n        [version]: null,\r\n      }));\r\n      return;\r\n    }\r\n    const data = await res.json();\r\n    setChangelogContent((prev) => ({\r\n      ...prev,\r\n      [version]: data?.changelog ?? null,\r\n    }));\r\n  }\r\n\r\n  async function loadReleaseNotes(version: number) {\r\n    if (releaseNotesContent[version] !== undefined) return;\r\n\r\n    const res = await fetch(\r\n      `/api/publish/release-notes?siteId=${siteId}&version=${version}`\r\n    );\r\n\r\n    if (!res.ok) {\r\n      setReleaseNotesContent((prev) => ({\r\n        ...prev,\r\n        [version]: null,\r\n      }));\r\n      return;\r\n    }\r\n\r\n    const data = await res.json();\r\n    setReleaseNotesContent((prev) => ({\r\n      ...prev,\r\n      [version]: data?.releaseNotes ?? null,\r\n    }));\r\n  }\r\n\r\n  const activePage = state?.pages.find((p) => p.id === state.activePageId) ?? state?.pages[0];\r\n\r\n  const blocks = activePage?.blocks ?? [];\r\n\r\n  function addBlock(type: string) {\r\n    if (!activePage) return\r\n    setState((prev: any) => ({\r\n      ...prev,\r\n      pages: prev.pages.map((p: any) =>\r\n        p.id === activePage.id\r\n          ? { ...p, blocks: [...p.blocks, { id: crypto.randomUUID(), type, data: {} }] }\r\n          : p\r\n      ),\r\n    }))\r\n  }\r\n\r\n  function updateBlockData(pageId: string, blockId: string, data: any) {\r\n    setState((prev: any) => ({\r\n      ...prev,\r\n      pages: prev.pages.map((p: any) =>\r\n        p.id === pageId\r\n          ? { ...p, blocks: p.blocks.map((b: any) => (b.id === blockId ? { ...b, data } : b)) }\r\n          : p\r\n      ),\r\n    }))\r\n  }\r\n\r\n  function removeBlock(id: string) {\r\n    if (!activePage) return\r\n    setState((prev: any) => ({\r\n      ...prev,\r\n      pages: prev.pages.map((p: any) =>\r\n        p.id === activePage.id ? { ...p, blocks: p.blocks.filter((b: any) => b.id !== id) } : p\r\n      ),\r\n    }))\r\n    if (selectedBlockId === id) setSelectedBlockId(null)\r\n  }\r\n\r\n  function moveBlock(pageId: string, blockId: string, direction: \"up\" | \"down\") {\r\n    setState((prev: any) => {\r\n      const pages = prev.pages.map((p: any) => {\r\n        if (p.id !== pageId) return p\r\n\r\n        const index = p.blocks.findIndex((b: any) => b.id === blockId)\r\n        if (index === -1) return p\r\n\r\n        const newBlocks = [...p.blocks]\r\n\r\n        if (direction === \"up\" && index > 0) {\r\n          const temp = newBlocks[index - 1]\r\n          newBlocks[index - 1] = newBlocks[index]\r\n          newBlocks[index] = temp\r\n        }\r\n\r\n        if (direction === \"down\" && index < newBlocks.length - 1) {\r\n          const temp = newBlocks[index + 1]\r\n          newBlocks[index + 1] = newBlocks[index]\r\n          newBlocks[index] = temp\r\n        }\r\n\r\n        return { ...p, blocks: newBlocks }\r\n      })\r\n\r\n      return { ...prev, pages }\r\n    })\r\n  }\r\n\r\n  function duplicateBlock(pageId: string, block: any) {\r\n    setState((prev: any) => {\r\n      const pages = prev.pages.map((p: any) => {\r\n        if (p.id !== pageId) return p\r\n\r\n        const newBlock = { ...block, id: crypto.randomUUID() }\r\n\r\n        return { ...p, blocks: [...p.blocks, newBlock] }\r\n      })\r\n\r\n      return { ...prev, pages }\r\n    })\r\n  }\r\n\r\n  function deleteBlock(pageId: string, blockId: string) {\r\n    setState((prev: any) => {\r\n      const pages = prev.pages.map((p: any) =>\r\n        p.id === pageId ? { ...p, blocks: p.blocks.filter((b: any) => b.id !== blockId) } : p\r\n      )\r\n      return { ...prev, pages }\r\n    })\r\n    if (selectedBlockId === blockId) setSelectedBlockId(null)\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex h-screen\">\r\n      <Sidebar blocks={blocks} selectedBlockId={selectedBlockId} onAddBlock={addBlock} onRemoveBlock={removeBlock} onSelectBlock={(id) => setSelectedBlockId(id)} />\r\n\r\n      <div className=\"flex-1 p-6 overflow-auto flex flex-col gap-4\">\r\n        <div className=\"flex items-center justify-between gap-4\">\r\n          <div className=\"min-w-0\">\r\n            <h1 className=\"text-xl font-semibold truncate\">\r\n              Editing: {activePage?.title ?? \"Untitled page\"}\r\n            </h1>\r\n            {publishMetadata?.lastPublishedAt && (\r\n              <p className=\"text-xs text-slate-500 mt-1\">\r\n                Last published: {\" \"}\r\n                {new Date(publishMetadata.lastPublishedAt).toLocaleString()}\r\n                {publishMetadata.lastPublishedVersion\r\n                  ? ` • Version ${publishMetadata.lastPublishedVersion}`\r\n                  : \"\"}\r\n              </p>\r\n            )}\r\n          </div>\r\n          <div className=\"flex flex-col items-end gap-1\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"px-3 py-1 text-xs rounded bg-purple-700 hover:bg-purple-600 disabled:opacity-50\"\r\n              disabled={isStaging}\r\n              onClick={handleStaging}\r\n            >\r\n              {isStaging ? \"Staging…\" : \"Staging\"}\r\n            </button>\r\n\r\n            <button\r\n              type=\"button\"\r\n              className=\"px-3 py-1 text-xs rounded bg-slate-700 hover:bg-slate-600 disabled:opacity-50\"\r\n              disabled={isPreviewing}\r\n              onClick={handlePreview}\r\n            >\r\n              {isPreviewing ? \"Previewing…\" : \"Preview\"}\r\n            </button>\r\n\r\n            <button\r\n              type=\"button\"\r\n              className=\"inline-flex items-center rounded-full bg-slate-900 text-white text-xs px-4 py-1.5 disabled:opacity-60\"\r\n              onClick={handlePublish}\r\n              disabled={isPublishing || !state}\r\n            >\r\n              {isPublishing ? \"Publishing…\" : \"Publish\"}\r\n            </button>\r\n\r\n        <a\r\n          href={`/site/${siteId}/changelog`}\r\n          className=\"text-xs underline text-blue-300\"\r\n        >\r\n          View Changelog\r\n        </a>\r\n\r\n        <a\r\n          href={`/site/${siteId}/settings`}\r\n          className=\"text-xs underline text-purple-300\"\r\n        >\r\n          Settings\r\n        </a>\r\n\r\n            <button\r\n              type=\"button\"\r\n              className=\"text-[10px] text-slate-400 underline\"\r\n              onClick={() => {\r\n                setShowHistory(!showHistory);\r\n                if (!publishHistory) loadHistory();\r\n              }}\r\n            >\r\n              {showHistory ? \"Hide history\" : \"View history\"}\r\n            </button>\r\n\r\n            {publishError && (\r\n              <p className=\"text-[10px] text-red-500 max-w-xs text-right\">\r\n                {publishError}\r\n              </p>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {previewUrl && (\r\n          <div className=\"mt-2 text-xs text-slate-300\">\r\n            Preview ready: {\" \"}\r\n            <a\r\n              href={previewUrl}\r\n              target=\"_blank\"\r\n              className=\"underline text-slate-200\"\r\n            >\r\n              {previewUrl}\r\n            </a>\r\n          </div>\r\n        )}\r\n\r\n        {stagingUrl && (\r\n          <div className=\"mt-2 text-xs text-purple-300\">\r\n            Staging ready: {\" \"}\r\n            <a\r\n              href={stagingUrl}\r\n              target=\"_blank\"\r\n              className=\"underline text-purple-200\"\r\n            >\r\n              {stagingUrl}\r\n            </a>\r\n          </div>\r\n        )}\r\n\r\n        {stagingError && (\r\n          <div className=\"mt-2 text-xs text-red-400\">\r\n            {stagingError}\r\n          </div>\r\n        )}\r\n\r\n        {showHistory && publishHistory && (\r\n          <div className=\"mt-4 border border-slate-800 rounded-lg p-3 bg-slate-900/40\">\r\n            <h2 className=\"text-sm font-semibold mb-2\">Publish History</h2>\r\n            <ul className=\"space-y-2 text-xs\">\r\n              {publishHistory.map((entry, i) => (\r\n                <li key={i} className=\"border-b border-slate-800 pb-1\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <span>\r\n                      Version {entry.version} — {\" \"}\r\n                      {new Date(entry.timestamp).toLocaleString()}\r\n                      {entry.rollback ? \" (rollback)\" : \"\"}\r\n                    </span>\r\n                    <div className=\"flex items-center gap-3\">\r\n                      {entry.url && (\r\n                        <a\r\n                          href={entry.url}\r\n                          target=\"_blank\"\r\n                          className=\"text-slate-400 underline\"\r\n                        >\r\n                          View\r\n                        </a>\r\n                      )}\r\n\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"text-slate-300 underline disabled:opacity-50\"\r\n                        disabled={isRestoring}\r\n                        onClick={() => handleRestore(entry.version)}\r\n                      >\r\n                        Restore\r\n                      </button>\r\n\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"text-slate-400 text-[10px] underline\"\r\n                        onClick={() => {\r\n                          const next =\r\n                            expandedChangelogVersion === entry.version\r\n                              ? null\r\n                              : entry.version;\r\n                          setExpandedChangelogVersion(next);\r\n                          if (next !== null) loadChangelog(next);\r\n                        }}\r\n                      >\r\n                        {expandedChangelogVersion === entry.version\r\n                          ? \"Hide changelog\"\r\n                          : \"View changelog\"}\r\n                      </button>\r\n\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"text-slate-400 text-[10px] underline\"\r\n                        onClick={() => {\r\n                          const next =\r\n                            expandedReleaseNotesVersion === entry.version\r\n                              ? null\r\n                              : entry.version;\r\n                          setExpandedReleaseNotesVersion(next);\r\n                          if (next !== null) loadReleaseNotes(next);\r\n                        }}\r\n                      >\r\n                        {expandedReleaseNotesVersion === entry.version\r\n                          ? \"Hide release notes\"\r\n                          : \"View release notes\"}\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {expandedChangelogVersion === entry.version && (\r\n                    <div className=\"mt-1 text-[11px] text-slate-300 whitespace-pre-line\">\r\n                      {changelogContent[entry.version] === undefined && (\r\n                        <span className=\"text-slate-500\">Loading changelog…</span>\r\n                      )}\r\n                      {changelogContent[entry.version] === null && (\r\n                        <span className=\"text-slate-500\">No changelog available for this version.</span>\r\n                      )}\r\n                      {changelogContent[entry.version] && changelogContent[entry.version]}\r\n                    </div>\r\n                  )}\r\n\r\n                  {expandedReleaseNotesVersion === entry.version && (\r\n                    <div className=\"mt-1 text-[11px] text-slate-300 whitespace-pre-line\">\r\n                      {releaseNotesContent[entry.version] === undefined && (\r\n                        <span className=\"text-slate-500\">Loading release notes…</span>\r\n                      )}\r\n                      {releaseNotesContent[entry.version] === null && (\r\n                        <span className=\"text-slate-500\">No release notes available for this version.</span>\r\n                      )}\r\n                      {releaseNotesContent[entry.version] && releaseNotesContent[entry.version]}\r\n                    </div>\r\n                  )}\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n        )}\r\n\r\n        <Canvas blocks={blocks} selectedBlockId={selectedBlockId} onSelectBlock={(id) => setSelectedBlockId(id)} />\r\n      </div>\r\n\r\n      <BlockEditorSidebar\r\n        block={blocks.find((b: any) => b.id === selectedBlockId) ?? null}\r\n        onChange={(data: any) => {\r\n          if (!selectedBlockId || !activePage) return\r\n\r\n          // Duplicate request\r\n          if ((data as any).__duplicate__) {\r\n            const original = blocks.find((b: any) => b.id === selectedBlockId)\r\n            if (original) duplicateBlock(activePage.id, original)\r\n            return\r\n          }\r\n\r\n          updateBlockData(activePage.id, selectedBlockId, data)\r\n        }}\r\n        onRegenerate={() => {\r\n          /* handled in Step 3 */\r\n        }}\r\n        onMoveUp={() => {\r\n          if (!selectedBlockId || !activePage) return\r\n          moveBlock(activePage.id, selectedBlockId, \"up\")\r\n        }}\r\n        onMoveDown={() => {\r\n          if (!selectedBlockId || !activePage) return\r\n          moveBlock(activePage.id, selectedBlockId, \"down\")\r\n        }}\r\n        onDelete={() => {\r\n          if (!selectedBlockId || !activePage) return\r\n          deleteBlock(activePage.id, selectedBlockId)\r\n        }}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport Hero from \"@/components/marketing/Hero\";\r\nimport FeatureGrid from \"@/components/marketing/FeatureGrid\";\r\nimport CTA from \"@/components/marketing/CTA\";\r\nimport FAQ from \"@/components/marketing/FAQ\";\r\nimport SocialProof from \"@/components/marketing/SocialProof\";\r\n\r\ntype Block = { id: string; type: string; data: any };\r\n\r\nexport default function BlockRenderer({ block }: { block: Block }) {\r\n  const { type, data } = block;\r\n\r\n  if (type === \"hero\") return <Hero {...(data || {})} />;\r\n  if (type === \"features\") return <FeatureGrid items={(data?.features) || []} />;\r\n  if (type === \"cta\") return <CTA {...(data || {})} />;\r\n  if (type === \"faq\") return <FAQ items={(data?.items) || []} />;\r\n  if (type === \"social-proof\") return <SocialProof {...(data || {})} />;\r\n\r\n  if (type === \"text\") return <div className=\"prose\" dangerouslySetInnerHTML={{ __html: data?.html || \"<p>Text block</p>\" }} />;\r\n\r\n  return <div className=\"text-sm text-slate-500\">Unknown block type: {type}</div>;\r\n}\r\n\r\n","\"use client\";\r\nimport React from 'react'\r\n\r\nexport default function SocialProof({ logos = [] }: { logos?: string[] }) {\r\n  return (\r\n    <section className=\"section-py-32\">\r\n      <div className=\"max-w-6xl mx-auto px-6\">\r\n        <h3 className=\"text-lg font-medium gradient-text\">Trusted by teams and creators</h3>\r\n        <div className=\"mt-6 flex flex-wrap items-center gap-6\">\r\n          {logos.length === 0 ? (\r\n            <p className=\"text-sm text-[rgba(255,255,255,0.85)]\">Join thousands of builders using BUILD WITH AI.</p>\r\n          ) : (\r\n            logos.map((l, i) => (\r\n              <img key={i} src={l} alt={`logo-${i}`} className=\"h-8 opacity-80\" />\r\n            ))\r\n          )}\r\n        </div>\r\n      </div>\r\n    </section>\r\n  )\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\n\r\nexport default function PageNavigator() {\r\n  return (\r\n    <div className=\"flex items-center justify-between\">\r\n      <div className=\"text-sm text-slate-600\">Page: Home</div>\r\n      <div className=\"flex gap-2\">\r\n        <button className=\"gds-btn\">Add page</button>\r\n        <button className=\"gds-btn\">Rename</button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport BlockRenderer from \"./BlockRenderer\";\r\nimport PageNavigator from \"./PageNavigator\";\r\n\r\ntype Block = { id: string; type: string; data: any };\r\ntype Props = { blocks: Block[]; className?: string; selectedBlockId?: string | null; onSelectBlock?: (id: string) => void };\r\n\r\nexport default function Canvas({ blocks = [], className = \"\", selectedBlockId, onSelectBlock }: Props) {\r\n  return (\r\n    <div className={`bg-white rounded-lg shadow p-6 ${className}`}>\r\n      <div className=\"mb-4\">\r\n        <PageNavigator />\r\n      </div>\r\n\r\n      <div className=\"space-y-6\">\r\n        {blocks.length === 0 && (\r\n          <div className=\"text-sm text-slate-500\">Empty page — add a block.</div>\r\n        )}\r\n        {blocks.map((b) => {\r\n          const isSelected = b.id === selectedBlockId;\r\n          return (\r\n            <div\r\n              key={b.id}\r\n              className={[\r\n                \"border rounded p-3 cursor-pointer transition-colors\",\r\n                isSelected ? \"border-slate-900 ring-2 ring-slate-900/40\" : \"border-slate-200 hover:border-slate-300\",\r\n              ].join(\" \")}\r\n              onClick={() => onSelectBlock?.(b.id)}\r\n            >\r\n              <div className={[(isSelected ? \"bg-slate-900 text-white\" : \"bg-slate-200 text-slate-700\"), \"absolute -mt-6 ml-3 text-[10px] px-1.5 py-0.5 rounded uppercase tracking-wide\"].join(\" \")}>{b.type}{isSelected ? \" • selected\" : \"\"}</div>\r\n              <BlockRenderer block={b} />\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport type { BuilderBlock } from \"@/types/builder\";\r\n\r\ntype Props = {\r\n  blocks: BuilderBlock[];\r\n  selectedBlockId?: string | null;\r\n  onAddBlock: (type: string) => void;\r\n  onRemoveBlock: (id: string) => void;\r\n  onSelectBlock?: (id: string) => void;\r\n};\r\n\r\nexport function Sidebar({\r\n  blocks,\r\n  selectedBlockId,\r\n  onAddBlock,\r\n  onRemoveBlock,\r\n  onSelectBlock,\r\n}: Props) {\r\n  const blockTypes = [\r\n    { type: \"hero\", label: \"Hero\" },\r\n    { type: \"features\", label: \"Features\" },\r\n    { type: \"testimonials\", label: \"Testimonials\" },\r\n    { type: \"faq\", label: \"FAQ\" },\r\n    { type: \"cta\", label: \"Call to Action\" },\r\n  ];\r\n\r\n  return (\r\n    <aside className=\"w-72 border-r bg-slate-50 p-4 flex flex-col gap-4\">\r\n      <div>\r\n        <h2 className=\"text-sm font-semibold mb-2\">Add sections</h2>\r\n        <div className=\"grid grid-cols-1 gap-2\">\r\n          {blockTypes.map((bt) => (\r\n            <button\r\n              key={bt.type}\r\n              className=\"border rounded px-3 py-2 text-xs text-left bg-white hover:bg-slate-100\"\r\n              onClick={() => onAddBlock(bt.type)}\r\n            >\r\n              {bt.label}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex-1\">\r\n        <h2 className=\"text-sm font-semibold mb-2\">Sections</h2>\r\n        {blocks.length === 0 ? (\r\n          <p className=\"text-xs text-slate-400\">No sections yet. Add a hero or features to start.</p>\r\n        ) : (\r\n          <ul className=\"space-y-1\">\r\n            {blocks.map((block, index) => {\r\n              const isSelected = block.id === selectedBlockId;\r\n              return (\r\n                <li\r\n                  key={block.id}\r\n                  className={[\r\n                    \"flex items-center justify-between text-xs border rounded px-2 py-1 cursor-pointer\",\r\n                    isSelected\r\n                      ? \"bg-slate-900 text-white border-slate-900\"\r\n                      : \"bg-white hover:bg-slate-100 border-slate-200\",\r\n                  ].join(\" \")}\r\n                  onClick={() => onSelectBlock?.(block.id)}\r\n                >\r\n                  <span className=\"truncate\">\r\n                    {index + 1}. {block.type}\r\n                    {isSelected && \" • editing\"}\r\n                  </span>\r\n                  <button\r\n                    className={\"text-[10px] \" + (isSelected ? \"text-slate-200\" : \"text-red-500\")}\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      onRemoveBlock(block.id);\r\n                    }}\r\n                  >\r\n                    Remove\r\n                  </button>\r\n                </li>\r\n              );\r\n            })}\r\n          </ul>\r\n        )}\r\n      </div>\r\n    </aside>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useRef } from \"react\";\r\n\r\ntype Props = {\r\n  label: string;\r\n  value?: string;\r\n  onChange: (value: string | null) => void;\r\n};\r\n\r\nexport function ImageField({ label, value, onChange }: Props) {\r\n  const inputRef = useRef<HTMLInputElement | null>(null);\r\n\r\n  function handleFile(e: React.ChangeEvent<HTMLInputElement>) {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return onChange(null);\r\n\r\n    const reader = new FileReader();\r\n    reader.onload = () => {\r\n      onChange(reader.result as string);\r\n    };\r\n    reader.readAsDataURL(file);\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-1\">\r\n      <label className=\"block text-xs font-medium text-slate-600\">{label}</label>\r\n\r\n      {value && (\r\n        <img\r\n          src={value}\r\n          alt=\"Preview\"\r\n          className=\"w-full h-auto rounded border mb-2\"\r\n        />\r\n      )}\r\n\r\n      <input\r\n        ref={inputRef}\r\n        type=\"file\"\r\n        accept=\"image/*\"\r\n        className=\"text-xs\"\r\n        onChange={handleFile}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\n\r\ntype Props = {\r\n  label: string;\r\n  value?: string;\r\n  onChange: (value: string) => void;\r\n};\r\n\r\nexport function TextField({ label, value, onChange }: Props) {\r\n  return (\r\n    <label className=\"block text-xs font-medium text-slate-600\">\r\n      {label}\r\n      <input\r\n        className=\"mt-1 w-full border rounded px-2 py-1 text-sm\"\r\n        value={value ?? \"\"}\r\n        onChange={(e) => onChange(e.target.value)}\r\n      />\r\n    </label>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\n\r\ntype FeatureItem = {\r\n  title: string;\r\n  description: string;\r\n};\r\n\r\ntype Props = {\r\n  items: FeatureItem[];\r\n  onChange: (items: FeatureItem[]) => void;\r\n};\r\n\r\nexport function FeatureListEditor({ items, onChange }: Props) {\r\n  function updateItem(index: number, key: keyof FeatureItem, value: string) {\r\n    const updated = [...items];\r\n    updated[index] = { ...updated[index], [key]: value };\r\n    onChange(updated);\r\n  }\r\n\r\n  function addItem() {\r\n    onChange([...items, { title: \"\", description: \"\" }]);\r\n  }\r\n\r\n  function removeItem(index: number) {\r\n    onChange(items.filter((_, i) => i !== index));\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-3\">\r\n      <h3 className=\"text-xs font-semibold text-slate-600\">Features</h3>\r\n\r\n      {items.map((item, index) => (\r\n        <div\r\n          key={index}\r\n          className=\"border rounded p-3 bg-slate-50 space-y-2 relative\"\r\n        >\r\n          <button\r\n            className=\"absolute top-2 right-2 text-red-500 text-xs\"\r\n            onClick={() => removeItem(index)}\r\n          >\r\n            ✕\r\n          </button>\r\n\r\n          <input\r\n            className=\"w-full border rounded px-2 py-1 text-xs\"\r\n            placeholder=\"Feature title\"\r\n            value={item.title}\r\n            onChange={(e) => updateItem(index, \"title\", e.target.value)}\r\n          />\r\n\r\n          <textarea\r\n            className=\"w-full border rounded px-2 py-1 text-xs\"\r\n            placeholder=\"Feature description\"\r\n            value={item.description}\r\n            onChange={(e) => updateItem(index, \"description\", e.target.value)}\r\n          />\r\n        </div>\r\n      ))}\r\n\r\n      <button\r\n        className=\"px-2 py-1 text-xs bg-slate-200 rounded hover:bg-slate-300\"\r\n        onClick={addItem}\r\n      >\r\n        + Add Feature\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\n\r\ntype FAQItem = {\r\n  question: string;\r\n  answer: string;\r\n};\r\n\r\ntype Props = {\r\n  items: FAQItem[];\r\n  onChange: (items: FAQItem[]) => void;\r\n};\r\n\r\nexport function FAQEditor({ items, onChange }: Props) {\r\n  function updateItem(index: number, key: keyof FAQItem, value: string) {\r\n    const updated = [...items];\r\n    updated[index] = { ...updated[index], [key]: value };\r\n    onChange(updated);\r\n  }\r\n\r\n  function addItem() {\r\n    onChange([...items, { question: \"\", answer: \"\" }]);\r\n  }\r\n\r\n  function removeItem(index: number) {\r\n    onChange(items.filter((_, i) => i !== index));\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-3\">\r\n      <h3 className=\"text-xs font-semibold text-slate-600\">FAQ Items</h3>\r\n\r\n      {items.map((item, index) => (\r\n        <div\r\n          key={index}\r\n          className=\"border rounded p-3 bg-slate-50 space-y-2 relative\"\r\n        >\r\n          <button\r\n            className=\"absolute top-2 right-2 text-red-500 text-xs\"\r\n            onClick={() => removeItem(index)}\r\n          >\r\n            ✕\r\n          </button>\r\n\r\n          <input\r\n            className=\"w-full border rounded px-2 py-1 text-xs\"\r\n            placeholder=\"Question\"\r\n            value={item.question}\r\n            onChange={(e) => updateItem(index, \"question\", e.target.value)}\r\n          />\r\n\r\n          <textarea\r\n            className=\"w-full border rounded px-2 py-1 text-xs\"\r\n            placeholder=\"Answer\"\r\n            value={item.answer}\r\n            onChange={(e) => updateItem(index, \"answer\", e.target.value)}\r\n          />\r\n        </div>\r\n      ))}\r\n\r\n      <button\r\n        className=\"px-2 py-1 text-xs bg-slate-200 rounded hover:bg-slate-300\"\r\n        onClick={addItem}\r\n      >\r\n        + Add FAQ Item\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\n\r\ntype Testimonial = {\r\n  name: string;\r\n  quote: string;\r\n  avatar?: string;\r\n};\r\n\r\ntype Props = {\r\n  testimonials: Testimonial[];\r\n  onChange: (items: Testimonial[]) => void;\r\n};\r\n\r\nexport function TestimonialEditor({ testimonials, onChange }: Props) {\r\n  function updateItem(index: number, key: keyof Testimonial, value: string) {\r\n    const updated = [...testimonials];\r\n    updated[index] = { ...updated[index], [key]: value };\r\n    onChange(updated);\r\n  }\r\n\r\n  function addItem() {\r\n    onChange([...testimonials, { name: \"\", quote: \"\", avatar: \"\" }]);\r\n  }\r\n\r\n  function removeItem(index: number) {\r\n    onChange(testimonials.filter((_, i) => i !== index));\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-3\">\r\n      <h3 className=\"text-xs font-semibold text-slate-600\">Testimonials</h3>\r\n\r\n      {testimonials.map((item, index) => (\r\n        <div\r\n          key={index}\r\n          className=\"border rounded p-3 bg-slate-50 space-y-2 relative\"\r\n        >\r\n          <button\r\n            className=\"absolute top-2 right-2 text-red-500 text-xs\"\r\n            onClick={() => removeItem(index)}\r\n          >\r\n            ✕\r\n          </button>\r\n\r\n          <input\r\n            className=\"w-full border rounded px-2 py-1 text-xs\"\r\n            placeholder=\"Name\"\r\n            value={item.name}\r\n            onChange={(e) => updateItem(index, \"name\", e.target.value)}\r\n          />\r\n\r\n          <textarea\r\n            className=\"w-full border rounded px-2 py-1 text-xs\"\r\n            placeholder=\"Quote\"\r\n            value={item.quote}\r\n            onChange={(e) => updateItem(index, \"quote\", e.target.value)}\r\n          />\r\n\r\n          <input\r\n            className=\"w-full border rounded px-2 py-1 text-xs\"\r\n            placeholder=\"Avatar URL\"\r\n            value={item.avatar}\r\n            onChange={(e) => updateItem(index, \"avatar\", e.target.value)}\r\n          />\r\n        </div>\r\n      ))}\r\n\r\n      <button\r\n        className=\"px-2 py-1 text-xs bg-slate-200 rounded hover:bg-slate-300\"\r\n        onClick={addItem}\r\n      >\r\n        + Add Testimonial\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\n\r\ntype Props = {\r\n  value?: string;\r\n  onChange: (value: string) => void;\r\n};\r\n\r\nexport function ToneSelector({ value, onChange }: Props) {\r\n  const tones = [\"professional\", \"friendly\", \"bold\", \"playful\", \"luxury\"];\r\n\r\n  return (\r\n    <div className=\"space-y-1\">\r\n      <label className=\"block text-xs font-medium text-slate-600\">\r\n        Tone / Style\r\n      </label>\r\n\r\n      <select\r\n        className=\"w-full border rounded px-2 py-1 text-sm\"\r\n        value={value ?? \"\"}\r\n        onChange={(e) => onChange(e.target.value)}\r\n      >\r\n        <option value=\"\">Default</option>\r\n        {tones.map((tone) => (\r\n          <option key={tone} value={tone}>\r\n            {tone}\r\n          </option>\r\n        ))}\r\n      </select>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useState } from \"react\";\r\n\r\ntype Props = {\r\n  text?: string;\r\n  onRewrite: (value: string) => void;\r\n};\r\n\r\nexport function AIRewriteButton({ text, onRewrite }: Props) {\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  async function handleRewrite() {\r\n    if (!text) return;\r\n    setLoading(true);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/ai/content\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ slot: \"rewrite\", context: { text } }),\r\n      });\r\n\r\n      const json = await res.json();\r\n      if (json?.text) onRewrite(json.text);\r\n    } catch (err) {\r\n      console.error(\"[AI_REWRITE_ERROR]\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <button\r\n      onClick={handleRewrite}\r\n      disabled={loading}\r\n      className=\"text-xs px-2 py-1 bg-slate-200 rounded hover:bg-slate-300\"\r\n    >\r\n      {loading ? \"Rewriting…\" : \"Rewrite with AI\"}\r\n    </button>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useState } from \"react\";\r\nimport type { BuilderBlock } from \"@/types/builder\";\r\nimport { ImageField } from \"./editors/ImageField\";\r\nimport { TextField } from \"./editors/TextField\";\r\nimport { FeatureListEditor } from \"./editors/FeatureListEditor\";\r\nimport { FAQEditor } from \"./editors/FAQEditor\";\r\nimport { TestimonialEditor } from \"./editors/TestimonialEditor\";\r\nimport { ToneSelector } from \"./editors/ToneSelector\";\r\nimport { AIRewriteButton } from \"./editors/AIRewriteButton\";\r\n\r\ntype Props = {\r\n  block: BuilderBlock | null;\r\n  onChange: (data: Record<string, any>) => void;\r\n  onRegenerate: () => void;\r\n  onMoveUp: () => void;\r\n  onMoveDown: () => void;\r\n  onDelete: () => void;\r\n};\r\n\r\nexport default function BlockEditorSidebar({\r\n  block,\r\n  onChange,\r\n  onRegenerate,\r\n  onMoveUp,\r\n  onMoveDown,\r\n  onDelete,\r\n}: Props) {\r\n  if (!block) {\r\n    return (\r\n      <aside className=\"w-96 border-l bg-slate-50 p-6 text-sm text-slate-500\">\r\n        Select a section to edit its content.\r\n      </aside>\r\n    );\r\n  }\r\n\r\n  const [localData, setLocalData] = useState(block.data ?? {});\r\n\r\n  function updateField(key: string, value: any) {\r\n    const updated = { ...localData, [key]: value };\r\n    setLocalData(updated);\r\n    onChange(updated);\r\n  }\r\n\r\n  function renderFields() {\r\n    if (!block) return null;\r\n    switch (block.type) {\r\n      case \"hero\":\r\n        return (\r\n          <div className=\"space-y-4\">\r\n            <TextField\r\n              label=\"Heading\"\r\n              value={localData.heading}\r\n              onChange={(v) => updateField(\"heading\", v)}\r\n            />\r\n            <AIRewriteButton\r\n              text={localData.heading}\r\n              onRewrite={(v) => updateField(\"heading\", v)}\r\n            />\r\n\r\n            <TextField\r\n              label=\"Subheading\"\r\n              value={localData.subheading}\r\n              onChange={(v) => updateField(\"subheading\", v)}\r\n            />\r\n            <AIRewriteButton\r\n              text={localData.subheading}\r\n              onRewrite={(v) => updateField(\"subheading\", v)}\r\n            />\r\n\r\n            <TextField\r\n              label=\"Primary CTA\"\r\n              value={localData.primaryCta}\r\n              onChange={(v) => updateField(\"primaryCta\", v)}\r\n            />\r\n\r\n            <TextField\r\n              label=\"Secondary CTA\"\r\n              value={localData.secondaryCta}\r\n              onChange={(v) => updateField(\"secondaryCta\", v)}\r\n            />\r\n\r\n            <ImageField\r\n              label=\"Hero Image\"\r\n              value={localData.image}\r\n              onChange={(v) => updateField(\"image\", v)}\r\n            />\r\n          </div>\r\n        );\r\n\r\n      case \"features\":\r\n        return (\r\n          <div className=\"space-y-4\">\r\n            <TextField\r\n              label=\"Title\"\r\n              value={localData.title}\r\n              onChange={(v) => updateField(\"title\", v)}\r\n            />\r\n            <AIRewriteButton\r\n              text={localData.title}\r\n              onRewrite={(v) => updateField(\"title\", v)}\r\n            />\r\n\r\n            <TextField\r\n              label=\"Subtitle\"\r\n              value={localData.subtitle}\r\n              onChange={(v) => updateField(\"subtitle\", v)}\r\n            />\r\n            <AIRewriteButton\r\n              text={localData.subtitle}\r\n              onRewrite={(v) => updateField(\"subtitle\", v)}\r\n            />\r\n\r\n            <FeatureListEditor\r\n              items={localData.items ?? []}\r\n              onChange={(v) => updateField(\"items\", v)}\r\n            />\r\n          </div>\r\n        );\r\n\r\n      case \"faq\":\r\n        return (\r\n          <FAQEditor\r\n            items={localData.items ?? []}\r\n            onChange={(v) => updateField(\"items\", v)}\r\n          />\r\n        );\r\n\r\n      case \"testimonials\":\r\n        return (\r\n          <TestimonialEditor\r\n            testimonials={localData.testimonials ?? []}\r\n            onChange={(v) => updateField(\"testimonials\", v)}\r\n          />\r\n        );\r\n\r\n      case \"cta\":\r\n        return (\r\n          <div className=\"space-y-4\">\r\n            <TextField\r\n              label=\"Heading\"\r\n              value={localData.heading}\r\n              onChange={(v) => updateField(\"heading\", v)}\r\n            />\r\n            <AIRewriteButton\r\n              text={localData.heading}\r\n              onRewrite={(v) => updateField(\"heading\", v)}\r\n            />\r\n\r\n            <TextField\r\n              label=\"Subheading\"\r\n              value={localData.subheading}\r\n              onChange={(v) => updateField(\"subheading\", v)}\r\n            />\r\n            <AIRewriteButton\r\n              text={localData.subheading}\r\n              onRewrite={(v) => updateField(\"subheading\", v)}\r\n            />\r\n\r\n            <TextField\r\n              label=\"Primary CTA\"\r\n              value={localData.primaryCta}\r\n              onChange={(v) => updateField(\"primaryCta\", v)}\r\n            />\r\n\r\n            <TextField\r\n              label=\"Secondary CTA\"\r\n              value={localData.secondaryCta}\r\n              onChange={(v) => updateField(\"secondaryCta\", v)}\r\n            />\r\n          </div>\r\n        );\r\n\r\n      default:\r\n        return (\r\n          <p className=\"text-xs text-slate-500\">\r\n            No editor available for block type: {block.type}\r\n          </p>\r\n        );\r\n    }\r\n  }\r\n\r\n  return (\r\n    <aside className=\"w-96 border-l bg-white p-6 overflow-y-auto\">\r\n      <h2 className=\"text-lg font-semibold mb-4\">Edit Section</h2>\r\n\r\n      <div className=\"space-y-6\">{renderFields()}</div>\r\n\r\n      <div className=\"mt-8 space-y-4\">\r\n        <ToneSelector\r\n          value={localData.tone}\r\n          onChange={(v) => updateField(\"tone\", v)}\r\n        />\r\n\r\n        <button\r\n          onClick={async () => {\r\n            try {\r\n              const res = await fetch(\"/api/ai/section/generate\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify({\r\n                  section: {\r\n                    id: block.id,\r\n                    type: block.type,\r\n                    data: localData,\r\n                  },\r\n                  context: {\r\n                    tone: localData.tone,\r\n                  },\r\n                }),\r\n              });\r\n\r\n              const json = await res.json();\r\n\r\n              if (json?.section?.data) {\r\n                // Merge AI output with existing data (preserve user edits)\r\n                const merged = {\r\n                  ...localData,\r\n                  ...json.section.data,\r\n                };\r\n                setLocalData(merged);\r\n                onChange(merged);\r\n              }\r\n            } catch (err) {\r\n              console.error(\"[AI_REGENERATE_ERROR]\", err);\r\n            }\r\n          }}\r\n          className=\"w-full px-4 py-2 rounded bg-slate-900 text-white text-sm\"\r\n        >\r\n          Regenerate with AI\r\n        </button>\r\n\r\n        <div className=\"flex items-center justify-between text-xs text-slate-600\">\r\n          <button onClick={onMoveUp} className=\"hover:text-slate-900\">\r\n            ↑ Move Up\r\n          </button>\r\n          <button onClick={onMoveDown} className=\"hover:text-slate-900\">\r\n            ↓ Move Down\r\n          </button>\r\n          <button\r\n            onClick={() => {\r\n              // Duplicate block by cloning localData\r\n              const clone = { ...localData };\r\n              onChange({ __duplicate__: true, ...clone });\r\n            }}\r\n            className=\"hover:text-slate-900\"\r\n          >\r\n            Duplicate\r\n          </button>\r\n          <button onClick={onDelete} className=\"text-red-500 hover:text-red-700\">\r\n            Delete\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </aside>\r\n  );\r\n}\r\n","// Thin Vercel KV adapter. If @vercel/kv is not installed or KV is not configured,\r\n// these functions fail gracefully and return null / noop. A conservative\r\n// no-write fallback is implemented so we can avoid attempting writes when the\r\n// deployment only provides a read-only token.\r\nlet kvClient: any = null\r\n// Flags will be computed after env mapping so they reflect mapped UPSTASH vars\r\nlet WRITE_ENABLED = false\r\nlet READ_ONLY_ONLY = false\r\nlet NO_WRITE_FALLBACK = false\r\n\r\ntry {\r\n  // If the project already has UPSTASH_REDIS_REST_URL / UPSTASH_REDIS_REST_TOKEN\r\n  // or custom WRITE/READ env names set, map them to the names expected by\r\n  // `@vercel/kv` at runtime so the package can pick them up without changing\r\n  // Vercel project env names. Do NOT log values or expose secrets.\r\n  if (!process.env.KV_REST_API_URL) {\r\n    process.env.KV_REST_API_URL = process.env.UPSTASH_REDIS_REST_URL || process.env.KV_REST_API_URL\r\n  }\r\n  if (!process.env.KV_REST_API_TOKEN) {\r\n    process.env.KV_REST_API_TOKEN = process.env.KV_REST_API_WRITE_TOKEN || process.env.UPSTASH_REDIS_REST_TOKEN || process.env.KV_REST_API_READ_ONLY_TOKEN || process.env.KV_REST_API_TOKEN\r\n  }\r\n\r\n  // Compute write/read flags after any env mapping above so they reflect\r\n  // the effective environment variables (e.g. UPSTASH -> KV mapping).\r\n  WRITE_ENABLED = !!(process.env.KV_REST_API_WRITE_TOKEN || process.env.KV_REST_API_TOKEN)\r\n  READ_ONLY_ONLY = !!process.env.KV_REST_API_READ_ONLY_TOKEN && !WRITE_ENABLED\r\n  NO_WRITE_FALLBACK = process.env.NO_WRITE_FALLBACK === 'true' || READ_ONLY_ONLY\r\n\r\n  // If explicit Upstash REST envs are present prefer a thin REST wrapper so\r\n  // local scripts and child processes use the same predictable code-path.\r\n  const earlyUpstashUrl = process.env.UPSTASH_REDIS_REST_URL\r\n  const earlyUpstashToken = process.env.UPSTASH_REDIS_REST_TOKEN\r\n  if (earlyUpstashUrl && earlyUpstashToken) {\r\n    const base = earlyUpstashUrl.replace(/\\/$/, '')\r\n    kvClient = {\r\n      async get(key: string) {\r\n        try {\r\n          const res = await fetch(`${base}/get/${encodeURIComponent(key)}`, {\r\n            headers: { Authorization: `Bearer ${earlyUpstashToken}` },\r\n          })\r\n          if (!res.ok) return null\r\n          const j = await res.json()\r\n          return j.result ?? null\r\n        } catch (err) {\r\n          console.error(\"[KV] early REST get() failed:\", err)\r\n          return null\r\n        }\r\n      },\r\n      async set(key: string, value: any) {\r\n        if (NO_WRITE_FALLBACK) return { skippedReadOnly: true }\r\n        try {\r\n          await fetch(`${base}/set/${encodeURIComponent(key)}`, {\r\n            method: 'POST',\r\n            headers: {\r\n              Authorization: `Bearer ${earlyUpstashToken}`,\r\n              'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({ value: typeof value === 'string' ? value : JSON.stringify(value) }),\r\n          })\r\n          return true\r\n        } catch (err) {\r\n          console.error(\"[KV] early REST set() failed:\", err)\r\n          return null\r\n        }\r\n      },\r\n      async expire(key: string, ttl: number) {\r\n        if (NO_WRITE_FALLBACK) return null\r\n        try {\r\n          await fetch(`${base}/expire/${encodeURIComponent(key)}`, {\r\n            method: 'POST',\r\n            headers: {\r\n              Authorization: `Bearer ${earlyUpstashToken}`,\r\n              'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({ ttl }),\r\n          })\r\n          return true\r\n        } catch (err) {\r\n          console.error(\"[KV] early REST expire() failed:\", err)\r\n          return null\r\n        }\r\n      },\r\n    }\r\n  }\r\n\r\n  // Construct the module name so static analyzers can't find the literal\r\n  const moduleName = '@' + 'vercel' + '/kv'\r\n  // Use eval to call require at runtime; this avoids bundlers resolving the import\r\n  // eslint-disable-next-line @typescript-eslint/no-implied-eval\r\n  // @ts-ignore\r\n  const kvModule = eval('require')(moduleName)\r\n\r\n  // Pick a candidate client from common export shapes\r\n  let candidate: any = kvModule?.kv ?? kvModule?.default ?? kvModule\r\n\r\n  // If the module exports a factory function, attempt to call it with env\r\n  if (typeof candidate === 'function') {\r\n    // Wrap factory in a lazy initializer so child processes or scripts that\r\n    // load env files after module import still work. The lazy wrapper will\r\n    // call the factory on first use with the current env values.\r\n    const factory = candidate\r\n    const makeLazy = (factoryFn: any) => {\r\n      let realClient: any = null\r\n      let initAttempted = false\r\n      const ensure = async () => {\r\n        if (realClient) return realClient\r\n        if (initAttempted) return realClient\r\n        initAttempted = true\r\n        try {\r\n          const url = process.env.KV_REST_API_URL || process.env.UPSTASH_REDIS_REST_URL\r\n          const token = process.env.KV_REST_API_TOKEN || process.env.UPSTASH_REDIS_REST_TOKEN\r\n          realClient = await factoryFn({ url, token })\r\n          if (!(realClient && typeof realClient.get === 'function' && typeof realClient.set === 'function')) {\r\n            realClient = null\r\n          }\r\n        } catch (err) {\r\n          realClient = null\r\n        }\r\n        return realClient\r\n      }\r\n      return {\r\n        async get(k: string) {\r\n          const c = await ensure()\r\n          if (!c) throw new Error('kv_not_initialized')\r\n          return c.get(k)\r\n        },\r\n        async set(k: string, v: any) {\r\n          const c = await ensure()\r\n          if (!c) throw new Error('kv_not_initialized')\r\n          return c.set(k, v)\r\n        },\r\n        async expire(k: string, t: number) {\r\n          const c = await ensure()\r\n          if (!c) throw new Error('kv_not_initialized')\r\n          if (typeof c.expire === 'function') return c.expire(k, t)\r\n          return null\r\n        },\r\n      }\r\n    }\r\n\r\n    try {\r\n      candidate = makeLazy(factory)\r\n    } catch (err) {\r\n      // ignore and validate below\r\n    }\r\n  }\r\n\r\n  // Validate that candidate exposes get/set\r\n  if (candidate && typeof candidate.get === 'function' && typeof candidate.set === 'function') {\r\n    kvClient = candidate\r\n  } else {\r\n    // Diagnostic + force fallback to Upstash REST in the catch block below\r\n    console.warn('[KV] Falling back to Upstash REST wrapper: invalid client shape', Object.keys(kvModule || {}))\r\n    throw new Error('invalid_kv_client_shape')\r\n  }\r\n} catch (e) {\r\n  // package not installed or not available in this environment; try an\r\n  // Upstash REST fallback if UPSTASH_REDIS_REST_URL/TOKEN are available.\r\n  const upstashUrl = process.env.UPSTASH_REDIS_REST_URL\r\n  const upstashToken = process.env.UPSTASH_REDIS_REST_TOKEN\r\n  if (upstashUrl && upstashToken) {\r\n    const base = upstashUrl.replace(/\\/$/, '')\r\n    kvClient = {\r\n      async get(key: string) {\r\n        try {\r\n          const res = await fetch(`${base}/get/${encodeURIComponent(key)}`, {\r\n            headers: { Authorization: `Bearer ${upstashToken}` },\r\n          })\r\n          if (!res.ok) return null\r\n          const j = await res.json()\r\n          return j.result ?? null\r\n        } catch (err) {\r\n          console.error(\"[KV] get() failed:\", err)\r\n          return null\r\n        }\r\n      },\r\n      async set(key: string, value: any) {\r\n        if (NO_WRITE_FALLBACK) return { skippedReadOnly: true }\r\n        try {\r\n          // Upstash expects simple JSON with `value` field for the set endpoint\r\n          await fetch(`${base}/set/${encodeURIComponent(key)}`, {\r\n            method: 'POST',\r\n            headers: {\r\n              Authorization: `Bearer ${upstashToken}`,\r\n              'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({ value: typeof value === 'string' ? value : JSON.stringify(value) }),\r\n          })\r\n          return true\r\n        } catch (err) {\r\n          console.error(\"[KV] set() failed:\", err)\r\n          return null\r\n        }\r\n      },\r\n      async expire(key: string, ttl: number) {\r\n        if (NO_WRITE_FALLBACK) return null\r\n        try {\r\n          await fetch(`${base}/expire/${encodeURIComponent(key)}`, {\r\n            method: 'POST',\r\n            headers: {\r\n              Authorization: `Bearer ${upstashToken}`,\r\n              'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({ ttl }),\r\n          })\r\n          return true\r\n        } catch (err) {\r\n          console.error(\"[KV] expire() failed:\", err)\r\n          return null\r\n        }\r\n      },\r\n    }\r\n  } else {\r\n    kvClient = null\r\n  }\r\n}\r\n\r\nconst RDAP_TTL_SECONDS = 300\r\n\r\nexport async function kvGetRdap(domain: string) {\r\n  if (!kvClient) return null\r\n  try {\r\n    const key = `rdap:${domain.toLowerCase()}`\r\n    const value = await kvClient.get(key)\r\n    return value ?? null\r\n  } catch (e) {\r\n    return null\r\n  }\r\n}\r\n\r\nexport async function kvSetRdap(domain: string, value: any) {\r\n  if (!kvClient) return null\r\n  if (NO_WRITE_FALLBACK) return { skippedReadOnly: true }\r\n  try {\r\n    const key = `rdap:${domain.toLowerCase()}`\r\n    // @vercel/kv supports expire via .set with options in newer versions; use simple set\r\n    const setResult = await kvClient.set(key, value)\r\n    // If the client supports expiration, set TTL separately (best-effort)\r\n    try {\r\n      if (typeof kvClient.expire === 'function') await kvClient.expire(key, RDAP_TTL_SECONDS)\r\n    } catch (_) {\r\n      // ignore\r\n    }\r\n    return setResult\r\n  } catch (e) {\r\n    // fail silently\r\n    return null\r\n  }\r\n}\r\n\r\n// Lightweight generic KV helper (non-breaking addition).\r\n// Provides `kv.get(key)` and `kv.set(key, value, { ex })` to support debug routes.\r\nexport const kv = {\r\n  async get(key: string) {\r\n    if (!kvClient) return null\r\n    try {\r\n      const v = await kvClient.get(key)\r\n      // Normalize multiple possible shapes returned by different clients\r\n      //  - raw primitive (number/string)\r\n      //  - JSON string (\"{...}\")\r\n      //  - wrapped object like { value: \"...\" }\r\n      if (v === null || v === undefined) return null\r\n\r\n      let parsed: any = v\r\n      if (typeof v === 'string') {\r\n        try {\r\n          parsed = JSON.parse(v)\r\n        } catch (_) {\r\n          parsed = v\r\n        }\r\n      }\r\n\r\n      // If the stored value is wrapped as { value: \"...\" }, unwrap it.\r\n      if (parsed && typeof parsed === 'object' && 'value' in parsed) {\r\n        const inner = parsed.value\r\n        if (typeof inner === 'string') {\r\n          try {\r\n            return JSON.parse(inner)\r\n          } catch (_) {\r\n            return inner\r\n          }\r\n        }\r\n        return inner\r\n      }\r\n\r\n      return parsed\r\n    } catch (err) {\r\n      console.error(\"[KV] get() failed:\", err)\r\n      // If the underlying client failed due to an invalid/missing base URL,\r\n      // attempt a best-effort direct Upstash REST fallback using environment\r\n      // variables. This helps in child-process/test runtimes where the\r\n      // installed client was initialized with undefined env values.\r\n      try {\r\n        if (process.env.UPSTASH_REDIS_REST_URL && process.env.UPSTASH_REDIS_REST_TOKEN) {\r\n          const base = (process.env.UPSTASH_REDIS_REST_URL || '').replace(/\\/$/, '')\r\n          const upstashToken = process.env.UPSTASH_REDIS_REST_TOKEN\r\n          const url = `${base}/get/${encodeURIComponent(key)}`\r\n          console.log('[KV] attempting Upstash REST fallback GET', url)\r\n          const res = await fetch(url, {\r\n            headers: { Authorization: `Bearer ${upstashToken}` },\r\n          })\r\n          console.log('[KV] upstash REST fallback status', res.status)\r\n          if (!res.ok) return null\r\n          const j = await res.json()\r\n          console.log('[KV] upstash REST fallback body keys', Object.keys(j || {}))\r\n          return j.result ?? null\r\n        }\r\n      } catch (fallbackErr) {\r\n        console.error('[KV] upstash REST fallback failed:', fallbackErr)\r\n      }\r\n      return null\r\n    }\r\n  },\r\n  async set(key: string, value: any, opts?: { ex?: number }) {\r\n    if (!kvClient) return null\r\n    if (NO_WRITE_FALLBACK) return { skippedReadOnly: true }\r\n    try {\r\n      // Avoid double-encoding: pass raw values to the underlying client and\r\n      // let that client (or our Upstash REST wrapper) handle any required\r\n      // encoding. This prevents nested JSON like \"{\\\"value\\\":\\\"1\\\"}\".\r\n      const setResult = await kvClient.set(key, value)\r\n      if (opts?.ex && typeof kvClient.expire === 'function') {\r\n        try {\r\n          await kvClient.expire(key, Math.ceil(opts.ex))\r\n        } catch (_) {\r\n          // ignore\r\n        }\r\n      }\r\n      return setResult\r\n    } catch (err) {\r\n      console.error(\"[KV] set() failed:\", err)\r\n      return null\r\n    }\r\n  },\r\n}\r\n\r\nexport default { kvGetRdap, kvSetRdap }\r\n\r\nexport function getKvStatus() {\r\n  return {\r\n    writeEnabled: WRITE_ENABLED,\r\n    readOnlyOnly: READ_ONLY_ONLY,\r\n    noWriteFallback: NO_WRITE_FALLBACK,\r\n    kvClientPresent: !!kvClient,\r\n    kvUrl: process.env.KV_REST_API_URL || process.env.UPSTASH_REDIS_REST_URL || null,\r\n  }\r\n}\r\n\r\n// Temporary debug helper — writes and reads a test key and logs results.\r\nexport async function debugKvRoundTrip() {\r\n  const key = \"debug:kv:test\"\r\n  const value = { ok: true, ts: Date.now() }\r\n  console.log(\"[KV] Writing test key:\", key)\r\n  const writeResult = await kv.set(key, JSON.stringify(value))\r\n  console.log(\"[KV] Write result:\", writeResult)\r\n  const readResult = await kv.get(key)\r\n  console.log(\"[KV] Read result:\", readResult)\r\n  return { writeResult, readResult }\r\n}\r\n","import { kv } from \"@/lib/kv\";\r\nimport type { BuilderState } from \"@/types/builder\";\r\n\r\nconst KEY_PREFIX = \"buildwithai:site:\";\r\n\r\nexport async function loadSiteState(\r\n  siteId: string\r\n): Promise<BuilderState | null> {\r\n  const key = `${KEY_PREFIX}${siteId}`;\r\n  const raw = await kv.get(key);\r\n  if (!raw) return null;\r\n\r\n  // `kv.get` may return a parsed object or a JSON string depending on the\r\n  // underlying client. Normalize to an object safely.\r\n  let parsed: any = raw;\r\n  if (typeof raw === \"string\") {\r\n    try {\r\n      parsed = JSON.parse(raw);\r\n    } catch {\r\n      // If parsing fails, treat as missing/invalid\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Validate minimal schema\r\n  if (!parsed || typeof parsed !== \"object\") return null;\r\n  if (!parsed.metadata || !parsed.pages) return null;\r\n\r\n  // Ensure metadata fields exist\r\n  parsed.metadata = {\r\n    id: parsed.metadata.id ?? siteId,\r\n    name: parsed.metadata.name ?? \"\",\r\n    description: parsed.metadata.description ?? \"\",\r\n    createdAt: parsed.metadata.createdAt ?? Date.now(),\r\n    updatedAt: parsed.metadata.updatedAt ?? Date.now(),\r\n    version: parsed.metadata.version ?? 1,\r\n  };\r\n\r\n  // Ensure pages array exists\r\n  if (!Array.isArray(parsed.pages)) parsed.pages = [];\r\n\r\n  return parsed as BuilderState;\r\n}\r\n","import { kv } from \"@/lib/kv\";\r\nimport type { BuilderState } from \"@/types/builder\";\r\n\r\nconst KEY_PREFIX = \"buildwithai:site:\";\r\n\r\nexport async function saveSiteState(\r\n  siteId: string,\r\n  state: BuilderState\r\n): Promise<void> {\r\n  const key = `${KEY_PREFIX}${siteId}`;\r\n  // Ensure metadata exists\r\n  const metadata = state.metadata ?? {\r\n    id: siteId,\r\n    createdAt: Date.now(),\r\n    updatedAt: Date.now(),\r\n    version: 1,\r\n  };\r\n\r\n  // Increment version + update timestamp\r\n  const nextMetadata = {\r\n    ...metadata,\r\n    updatedAt: Date.now(),\r\n    version: (metadata.version ?? 0) + 1,\r\n  };\r\n\r\n  const payload = JSON.stringify({\r\n    ...state,\r\n    metadata: nextMetadata,\r\n  });\r\n\r\n  await kv.set(key, payload);\r\n}\r\n\r\n// Backwards-compatible adapter expected by templates create route\r\nexport async function saveSite(siteId: string, state: BuilderState) {\r\n  return saveSiteState(siteId, state);\r\n}\r\n","import { kv } from \"@/lib/kv\";\r\n\r\nconst SITE_REGISTRY_PREFIX = \"buildwithai:sites\";\r\nconst SITE_REGISTRY_INDEX = \"buildwithai:sites:index\";\r\n\r\nexport type SiteRegistryEntry = {\r\n  id: string;\r\n  name: string;\r\n  createdAt: number;\r\n  updatedAt: number;\r\n};\r\n\r\nexport async function registerSite(id: string, name: string) {\r\n  const key = `${SITE_REGISTRY_PREFIX}:${id}`;\r\n  const existing = await kv.get(key);\r\n\r\n  if (existing) return existing;\r\n\r\n  const entry: SiteRegistryEntry = {\r\n    id,\r\n    name,\r\n    createdAt: Date.now(),\r\n    updatedAt: Date.now(),\r\n  };\r\n\r\n  await kv.set(key, entry);\r\n  // Add to index of sites\r\n  try {\r\n    const idx = (await kv.get(SITE_REGISTRY_INDEX)) as string[] | null;\r\n    const nextIdx = Array.isArray(idx) ? Array.from(new Set([...idx, id])) : [id];\r\n    await kv.set(SITE_REGISTRY_INDEX, nextIdx);\r\n  } catch (e) {\r\n    // ignore index update failures\r\n  }\r\n  return entry;\r\n}\r\n\r\nexport async function updateSiteTimestamp(id: string) {\r\n  const key = `${SITE_REGISTRY_PREFIX}:${id}`;\r\n  const entry = (await kv.get(key)) as SiteRegistryEntry | null;\r\n\r\n  if (!entry) return;\r\n\r\n  entry.updatedAt = Date.now();\r\n  await kv.set(key, entry);\r\n}\r\n\r\nexport async function listSites(): Promise<SiteRegistryEntry[]> {\r\n  const idx = (await kv.get(SITE_REGISTRY_INDEX)) as string[] | null;\r\n  const entries: SiteRegistryEntry[] = [];\r\n\r\n  if (!Array.isArray(idx) || idx.length === 0) return entries;\r\n\r\n  for (const id of idx) {\r\n    const key = `${SITE_REGISTRY_PREFIX}:${id}`;\r\n    const entry = await kv.get(key);\r\n    if (entry) entries.push(entry as SiteRegistryEntry);\r\n  }\r\n\r\n  return entries.sort((a, b) => b.updatedAt - a.updatedAt);\r\n}\r\n","import { loadSiteState } from \"@/lib/builder/load\";\r\n\r\nexport async function getSite(siteId: string) {\r\n  const state = await loadSiteState(siteId);\r\n  if (!state) return null;\r\n\r\n  return {\r\n    id: siteId,\r\n    name: state.metadata?.name ?? \"Untitled\",\r\n    createdAt: state.metadata?.createdAt ?? Date.now(),\r\n    updatedAt: state.metadata?.updatedAt ?? Date.now(),\r\n  };\r\n}\r\n"],"names":[],"mappings":"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"}