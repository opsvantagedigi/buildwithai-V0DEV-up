module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},36420,a=>{a.n(a.i(8613))},42196,a=>{a.n(a.i(70783))},86191,a=>{a.n(a.i(54961))},13164,a=>{a.n(a.i(78961))},93017,a=>{a.n(a.i(36636))},93476,a=>{"use strict";var b=a.i(83227);function c({rollups:a}){let c=a.map(a=>a.pageviews||0),d=Math.max(...c,1),e=c.map((a,b)=>{let e=b/Math.max(1,c.length-1)*300;return`${e},${100-a/d*100}`}).join(" ");return(0,b.jsx)("svg",{width:"100%",height:"120",viewBox:"0 0 300 120",children:(0,b.jsx)("polyline",{fill:"none",stroke:"#2563eb",strokeWidth:"3",points:e})})}function d({rollups:a}){let c=a.reduce((a,b)=>a+(b?.pageviews||0),0),d=a.reduce((a,b)=>a+(b?.uniques||0),0);return(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Total Pageviews"}),(0,b.jsx)("p",{className:"text-3xl font-bold mt-2",children:c})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Unique Visitors"}),(0,b.jsx)("p",{className:"text-3xl font-bold mt-2",children:d})]})]})}function e({heatmap:a}){return a&&0!==a.length?(0,b.jsx)("div",{className:"space-y-8",children:a.map(a=>(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:a.path}),(0,b.jsx)("div",{className:"relative border rounded-lg overflow-hidden",style:{width:"400px",height:"400px",background:"#f9fafb"},children:a.buckets.map((c,d)=>{let e=Math.min(1,c.count/10),f=`rgba(255, 0, 0, ${e})`,g=400/a.width,h=400/a.height;return(0,b.jsx)("div",{style:{position:"absolute",left:c.x*g,top:c.y*h,width:g,height:h,backgroundColor:f}},d)})})]},a.path))}):(0,b.jsx)("p",{className:"text-gray-500",children:"No heatmap data available."})}function f({metadata:a,timeline:c}){return c&&0!==c.length?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Session Info"}),(0,b.jsxs)("p",{children:["Session ID: ",a.sessionId]}),(0,b.jsxs)("p",{children:["Duration: ",Math.round((a.endedAt-a.startedAt)/1e3),"s"]}),(0,b.jsxs)("p",{children:["Pageviews: ",a.pageviewCount]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Timeline"}),(0,b.jsx)("ul",{className:"space-y-2",children:c.map(a=>(0,b.jsxs)("li",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:new Date(a.timestamp).toLocaleTimeString()}),(0,b.jsx)("span",{className:"font-semibold",children:a.type}),(0,b.jsx)("span",{children:a.path||""})]},a.id))})]})]}):(0,b.jsx)("p",{className:"text-gray-500",children:"No replay data available."})}function g({funnels:a,events:c}){return a&&0!==a.length?(0,b.jsx)("div",{className:"space-y-8",children:a.map(a=>{let d={};return c.forEach(b=>{"funnel_step"===b.type&&b.funnelId===a.id&&(d[b.stepId]=(d[b.stepId]||0)+1)}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold mb-4",children:a.name}),(0,b.jsx)("ul",{className:"space-y-2",children:a.steps.map(a=>(0,b.jsxs)("li",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:a.name}),(0,b.jsx)("span",{className:"font-semibold",children:d[a.id]||0})]},a.id))})]},a.id)})}):(0,b.jsx)("p",{className:"text-gray-500",children:"No funnels defined."})}function h({conversions:a,events:c}){if(!a||0===a.length)return(0,b.jsx)("p",{className:"text-gray-500",children:"No conversion goals defined."});let d={};return c.forEach(a=>{"conversion"===a.type&&(d[a.goal]=(d[a.goal]||0)+1)}),(0,b.jsx)("div",{className:"space-y-8",children:a.map(a=>(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold mb-4",children:a.name}),(0,b.jsx)("p",{className:"text-3xl font-bold",children:d[a.name]||0})]},a.id))})}async function i(a){let b=new Date,c=[...Array(7)].map((a,c)=>{let d=new Date(b);return d.setDate(b.getDate()-c),d.toISOString().slice(0,10)}),d=[];for(let b of c){let c=await fetch(`${process.env.NEXT_PUBLIC_BASE_URL}/api/analytics/rollup`,{method:"POST",body:JSON.stringify({siteId:a,date:b})}),e=await c.json().catch(()=>null);e?.rollup&&d.push(e.rollup)}return d.reverse()}async function j(a,b){let c=await fetch(`${process.env.NEXT_PUBLIC_BASE_URL}/api/analytics/replay?siteId=${a}&sessionId=dummy&date=${b}`),d=await c.json().catch(()=>null);return d?.heatmap||[]}async function k(a){let b=await fetch(`${process.env.NEXT_PUBLIC_BASE_URL}/api/analytics/funnels?siteId=${a}`),c=await b.json().catch(()=>null);return c?.funnels||[]}async function l(a){let b=await fetch(`${process.env.NEXT_PUBLIC_BASE_URL}/api/analytics/conversions?siteId=${a}`),c=await b.json().catch(()=>null);return c?.conversions||[]}async function m({params:a}){let m=a.id,q=await i(m),r=await k(m),s=await l(m),t=new Date().toISOString().slice(0,10),u=await j(m,t);return(0,b.jsxs)("div",{className:"p-8 space-y-12",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Analytics"}),(0,b.jsx)(d,{rollups:q}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Traffic (Last 7 Days)"}),(0,b.jsx)(c,{rollups:q})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Top Pages"}),(0,b.jsx)(n,{rollups:q})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Top Referrers"}),(0,b.jsx)(o,{rollups:q})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Devices"}),(0,b.jsx)(p,{rollups:q})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Funnels"}),(0,b.jsx)(g,{funnels:r,events:[]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Conversions"}),(0,b.jsx)(h,{conversions:s,events:[]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Heatmap"}),(0,b.jsx)(e,{heatmap:u})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Replay"}),(0,b.jsx)(f,{metadata:void 0,timeline:void 0})]})]})}function n({rollups:a}){let c={};a.forEach(a=>{Object.entries(a.paths).forEach(([a,b])=>{c[a]=(c[a]||0)+b.pageviews})});let d=Object.entries(c).sort((a,b)=>b[1]-a[1]);return(0,b.jsx)("ul",{className:"space-y-2",children:d.map(([a,c])=>(0,b.jsxs)("li",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:a}),(0,b.jsx)("span",{className:"font-semibold",children:c})]},a))})}function o({rollups:a}){let c={};a.forEach(a=>{Object.entries(a.referrers).forEach(([a,b])=>{c[a]=(c[a]||0)+b.pageviews})});let d=Object.entries(c).sort((a,b)=>b[1]-a[1]);return(0,b.jsx)("ul",{className:"space-y-2",children:d.map(([a,c])=>(0,b.jsxs)("li",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:a}),(0,b.jsx)("span",{className:"font-semibold",children:c})]},a))})}function p({rollups:a}){let c={desktop:0,mobile:0,tablet:0,other:0};return a.forEach(a=>{c.desktop+=a.devices.desktop,c.mobile+=a.devices.mobile,c.tablet+=a.devices.tablet,c.other+=a.devices.other}),(0,b.jsx)("ul",{className:"space-y-2",children:Object.entries(c).map(([a,c])=>(0,b.jsxs)("li",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"capitalize",children:a}),(0,b.jsx)("span",{className:"font-semibold",children:c})]},a))})}a.s(["default",()=>m],93476)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__d58011d9._.js.map