{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 45, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/buildwithai/src/lib/templates/blueprints/landing.json"],"sourcesContent":["{\"root\":{\"type\":\"page\",\"props\":{\"title\":\"Landing Page\",\"sections\":[{\"type\":\"hero\",\"props\":{\"headline\":\"Welcome to Your New Site\",\"subheadline\":\"Built with AI, powered by your vision.\"}},{\"type\":\"features\",\"props\":{\"items\":[{\"title\":\"Fast\",\"description\":\"Optimized for performance.\"},{\"title\":\"Beautiful\",\"description\":\"Designed with care.\"},{\"title\":\"Smart\",\"description\":\"AI‑powered workflows.\"}]}}]}}}"],"names":[],"mappings":"AAAA"}},
    {"offset": {"line": 45, "column": 429}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/buildwithai/src/lib/templates/blueprints/portfolio.json"],"sourcesContent":["{\"root\":{\"type\":\"page\",\"props\":{\"title\":\"Portfolio\",\"sections\":[{\"type\":\"hero\",\"props\":{\"headline\":\"My Work\",\"subheadline\":\"A showcase of selected projects.\"}},{\"type\":\"gallery\",\"props\":{\"items\":[{\"title\":\"Project One\",\"image\":\"/placeholder1.png\"},{\"title\":\"Project Two\",\"image\":\"/placeholder2.png\"},{\"title\":\"Project Three\",\"image\":\"/placeholder3.png\"}]}}]}}}"],"names":[],"mappings":"AAAA"}},
    {"offset": {"line": 48, "column": 386}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/AjaySidal/buildwithai/src/lib/kv.ts"],"sourcesContent":["// Thin Vercel KV adapter. If @vercel/kv is not installed or KV is not configured,\r\n// these functions fail gracefully and return null / noop. A conservative\r\n// no-write fallback is implemented so we can avoid attempting writes when the\r\n// deployment only provides a read-only token.\r\nlet kvClient: any = null\r\n// Flags will be computed after env mapping so they reflect mapped UPSTASH vars\r\nlet WRITE_ENABLED = false\r\nlet READ_ONLY_ONLY = false\r\nlet NO_WRITE_FALLBACK = false\r\n\r\ntry {\r\n  // If the project already has UPSTASH_REDIS_REST_URL / UPSTASH_REDIS_REST_TOKEN\r\n  // or custom WRITE/READ env names set, map them to the names expected by\r\n  // `@vercel/kv` at runtime so the package can pick them up without changing\r\n  // Vercel project env names. Do NOT log values or expose secrets.\r\n  if (!process.env.KV_REST_API_URL) {\r\n    process.env.KV_REST_API_URL = process.env.UPSTASH_REDIS_REST_URL || process.env.KV_REST_API_URL\r\n  }\r\n  if (!process.env.KV_REST_API_TOKEN) {\r\n    process.env.KV_REST_API_TOKEN = process.env.KV_REST_API_WRITE_TOKEN || process.env.UPSTASH_REDIS_REST_TOKEN || process.env.KV_REST_API_READ_ONLY_TOKEN || process.env.KV_REST_API_TOKEN\r\n  }\r\n\r\n  // Compute write/read flags after any env mapping above so they reflect\r\n  // the effective environment variables (e.g. UPSTASH -> KV mapping).\r\n  WRITE_ENABLED = !!(process.env.KV_REST_API_WRITE_TOKEN || process.env.KV_REST_API_TOKEN)\r\n  READ_ONLY_ONLY = !!process.env.KV_REST_API_READ_ONLY_TOKEN && !WRITE_ENABLED\r\n  NO_WRITE_FALLBACK = process.env.NO_WRITE_FALLBACK === 'true' || READ_ONLY_ONLY\r\n\r\n  // If explicit Upstash REST envs are present prefer a thin REST wrapper so\r\n  // local scripts and child processes use the same predictable code-path.\r\n  const earlyUpstashUrl = process.env.UPSTASH_REDIS_REST_URL\r\n  const earlyUpstashToken = process.env.UPSTASH_REDIS_REST_TOKEN\r\n  if (earlyUpstashUrl && earlyUpstashToken) {\r\n    const base = earlyUpstashUrl.replace(/\\/$/, '')\r\n    kvClient = {\r\n      async get(key: string) {\r\n        try {\r\n          const res = await fetch(`${base}/get/${encodeURIComponent(key)}`, {\r\n            headers: { Authorization: `Bearer ${earlyUpstashToken}` },\r\n          })\r\n          if (!res.ok) return null\r\n          const j = await res.json()\r\n          return j.result ?? null\r\n        } catch (err) {\r\n          console.error(\"[KV] early REST get() failed:\", err)\r\n          return null\r\n        }\r\n      },\r\n      async set(key: string, value: any) {\r\n        if (NO_WRITE_FALLBACK) return { skippedReadOnly: true }\r\n        try {\r\n          await fetch(`${base}/set/${encodeURIComponent(key)}`, {\r\n            method: 'POST',\r\n            headers: {\r\n              Authorization: `Bearer ${earlyUpstashToken}`,\r\n              'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({ value: typeof value === 'string' ? value : JSON.stringify(value) }),\r\n          })\r\n          return true\r\n        } catch (err) {\r\n          console.error(\"[KV] early REST set() failed:\", err)\r\n          return null\r\n        }\r\n      },\r\n      async expire(key: string, ttl: number) {\r\n        if (NO_WRITE_FALLBACK) return null\r\n        try {\r\n          await fetch(`${base}/expire/${encodeURIComponent(key)}`, {\r\n            method: 'POST',\r\n            headers: {\r\n              Authorization: `Bearer ${earlyUpstashToken}`,\r\n              'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({ ttl }),\r\n          })\r\n          return true\r\n        } catch (err) {\r\n          console.error(\"[KV] early REST expire() failed:\", err)\r\n          return null\r\n        }\r\n      },\r\n    }\r\n  }\r\n\r\n  // Construct the module name so static analyzers can't find the literal\r\n  const moduleName = '@' + 'vercel' + '/kv'\r\n  // Use eval to call require at runtime; this avoids bundlers resolving the import\r\n  // eslint-disable-next-line @typescript-eslint/no-implied-eval\r\n  // @ts-ignore\r\n  const kvModule = eval('require')(moduleName)\r\n\r\n  // Pick a candidate client from common export shapes\r\n  let candidate: any = kvModule?.kv ?? kvModule?.default ?? kvModule\r\n\r\n  // If the module exports a factory function, attempt to call it with env\r\n  if (typeof candidate === 'function') {\r\n    // Wrap factory in a lazy initializer so child processes or scripts that\r\n    // load env files after module import still work. The lazy wrapper will\r\n    // call the factory on first use with the current env values.\r\n    const factory = candidate\r\n    const makeLazy = (factoryFn: any) => {\r\n      let realClient: any = null\r\n      let initAttempted = false\r\n      const ensure = async () => {\r\n        if (realClient) return realClient\r\n        if (initAttempted) return realClient\r\n        initAttempted = true\r\n        try {\r\n          const url = process.env.KV_REST_API_URL || process.env.UPSTASH_REDIS_REST_URL\r\n          const token = process.env.KV_REST_API_TOKEN || process.env.UPSTASH_REDIS_REST_TOKEN\r\n          realClient = await factoryFn({ url, token })\r\n          if (!(realClient && typeof realClient.get === 'function' && typeof realClient.set === 'function')) {\r\n            realClient = null\r\n          }\r\n        } catch (err) {\r\n          realClient = null\r\n        }\r\n        return realClient\r\n      }\r\n      return {\r\n        async get(k: string) {\r\n          const c = await ensure()\r\n          if (!c) throw new Error('kv_not_initialized')\r\n          return c.get(k)\r\n        },\r\n        async set(k: string, v: any) {\r\n          const c = await ensure()\r\n          if (!c) throw new Error('kv_not_initialized')\r\n          return c.set(k, v)\r\n        },\r\n        async expire(k: string, t: number) {\r\n          const c = await ensure()\r\n          if (!c) throw new Error('kv_not_initialized')\r\n          if (typeof c.expire === 'function') return c.expire(k, t)\r\n          return null\r\n        },\r\n      }\r\n    }\r\n\r\n    try {\r\n      candidate = makeLazy(factory)\r\n    } catch (err) {\r\n      // ignore and validate below\r\n    }\r\n  }\r\n\r\n  // Validate that candidate exposes get/set\r\n  if (candidate && typeof candidate.get === 'function' && typeof candidate.set === 'function') {\r\n    kvClient = candidate\r\n  } else {\r\n    // Diagnostic + force fallback to Upstash REST in the catch block below\r\n    console.warn('[KV] Falling back to Upstash REST wrapper: invalid client shape', Object.keys(kvModule || {}))\r\n    throw new Error('invalid_kv_client_shape')\r\n  }\r\n} catch (e) {\r\n  // package not installed or not available in this environment; try an\r\n  // Upstash REST fallback if UPSTASH_REDIS_REST_URL/TOKEN are available.\r\n  const upstashUrl = process.env.UPSTASH_REDIS_REST_URL\r\n  const upstashToken = process.env.UPSTASH_REDIS_REST_TOKEN\r\n  if (upstashUrl && upstashToken) {\r\n    const base = upstashUrl.replace(/\\/$/, '')\r\n    kvClient = {\r\n      async get(key: string) {\r\n        try {\r\n          const res = await fetch(`${base}/get/${encodeURIComponent(key)}`, {\r\n            headers: { Authorization: `Bearer ${upstashToken}` },\r\n          })\r\n          if (!res.ok) return null\r\n          const j = await res.json()\r\n          return j.result ?? null\r\n        } catch (err) {\r\n          console.error(\"[KV] get() failed:\", err)\r\n          return null\r\n        }\r\n      },\r\n      async set(key: string, value: any) {\r\n        if (NO_WRITE_FALLBACK) return { skippedReadOnly: true }\r\n        try {\r\n          // Upstash expects simple JSON with `value` field for the set endpoint\r\n          await fetch(`${base}/set/${encodeURIComponent(key)}`, {\r\n            method: 'POST',\r\n            headers: {\r\n              Authorization: `Bearer ${upstashToken}`,\r\n              'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({ value: typeof value === 'string' ? value : JSON.stringify(value) }),\r\n          })\r\n          return true\r\n        } catch (err) {\r\n          console.error(\"[KV] set() failed:\", err)\r\n          return null\r\n        }\r\n      },\r\n      async expire(key: string, ttl: number) {\r\n        if (NO_WRITE_FALLBACK) return null\r\n        try {\r\n          await fetch(`${base}/expire/${encodeURIComponent(key)}`, {\r\n            method: 'POST',\r\n            headers: {\r\n              Authorization: `Bearer ${upstashToken}`,\r\n              'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({ ttl }),\r\n          })\r\n          return true\r\n        } catch (err) {\r\n          console.error(\"[KV] expire() failed:\", err)\r\n          return null\r\n        }\r\n      },\r\n    }\r\n  } else {\r\n    kvClient = null\r\n  }\r\n}\r\n\r\nconst RDAP_TTL_SECONDS = 300\r\n\r\nexport async function kvGetRdap(domain: string) {\r\n  if (!kvClient) return null\r\n  try {\r\n    const key = `rdap:${domain.toLowerCase()}`\r\n    const value = await kvClient.get(key)\r\n    return value ?? null\r\n  } catch (e) {\r\n    return null\r\n  }\r\n}\r\n\r\nexport async function kvSetRdap(domain: string, value: any) {\r\n  if (!kvClient) return null\r\n  if (NO_WRITE_FALLBACK) return { skippedReadOnly: true }\r\n  try {\r\n    const key = `rdap:${domain.toLowerCase()}`\r\n    // @vercel/kv supports expire via .set with options in newer versions; use simple set\r\n    const setResult = await kvClient.set(key, value)\r\n    // If the client supports expiration, set TTL separately (best-effort)\r\n    try {\r\n      if (typeof kvClient.expire === 'function') await kvClient.expire(key, RDAP_TTL_SECONDS)\r\n    } catch (_) {\r\n      // ignore\r\n    }\r\n    return setResult\r\n  } catch (e) {\r\n    // fail silently\r\n    return null\r\n  }\r\n}\r\n\r\n// Lightweight generic KV helper (non-breaking addition).\r\n// Provides `kv.get(key)` and `kv.set(key, value, { ex })` to support debug routes.\r\nexport const kv = {\r\n  async get(key: string) {\r\n    if (!kvClient) return null\r\n    try {\r\n      const v = await kvClient.get(key)\r\n      // Normalize multiple possible shapes returned by different clients\r\n      //  - raw primitive (number/string)\r\n      //  - JSON string (\"{...}\")\r\n      //  - wrapped object like { value: \"...\" }\r\n      if (v === null || v === undefined) return null\r\n\r\n      let parsed: any = v\r\n      if (typeof v === 'string') {\r\n        try {\r\n          parsed = JSON.parse(v)\r\n        } catch (_) {\r\n          parsed = v\r\n        }\r\n      }\r\n\r\n      // If the stored value is wrapped as { value: \"...\" }, unwrap it.\r\n      if (parsed && typeof parsed === 'object' && 'value' in parsed) {\r\n        const inner = parsed.value\r\n        if (typeof inner === 'string') {\r\n          try {\r\n            return JSON.parse(inner)\r\n          } catch (_) {\r\n            return inner\r\n          }\r\n        }\r\n        return inner\r\n      }\r\n\r\n      return parsed\r\n    } catch (err) {\r\n      console.error(\"[KV] get() failed:\", err)\r\n      // If the underlying client failed due to an invalid/missing base URL,\r\n      // attempt a best-effort direct Upstash REST fallback using environment\r\n      // variables. This helps in child-process/test runtimes where the\r\n      // installed client was initialized with undefined env values.\r\n      try {\r\n        if (process.env.UPSTASH_REDIS_REST_URL && process.env.UPSTASH_REDIS_REST_TOKEN) {\r\n          const base = (process.env.UPSTASH_REDIS_REST_URL || '').replace(/\\/$/, '')\r\n          const upstashToken = process.env.UPSTASH_REDIS_REST_TOKEN\r\n          const url = `${base}/get/${encodeURIComponent(key)}`\r\n          console.log('[KV] attempting Upstash REST fallback GET', url)\r\n          const res = await fetch(url, {\r\n            headers: { Authorization: `Bearer ${upstashToken}` },\r\n          })\r\n          console.log('[KV] upstash REST fallback status', res.status)\r\n          if (!res.ok) return null\r\n          const j = await res.json()\r\n          console.log('[KV] upstash REST fallback body keys', Object.keys(j || {}))\r\n          return j.result ?? null\r\n        }\r\n      } catch (fallbackErr) {\r\n        console.error('[KV] upstash REST fallback failed:', fallbackErr)\r\n      }\r\n      return null\r\n    }\r\n  },\r\n  async set(key: string, value: any, opts?: { ex?: number }) {\r\n    if (!kvClient) return null\r\n    if (NO_WRITE_FALLBACK) return { skippedReadOnly: true }\r\n    try {\r\n      // Avoid double-encoding: pass raw values to the underlying client and\r\n      // let that client (or our Upstash REST wrapper) handle any required\r\n      // encoding. This prevents nested JSON like \"{\\\"value\\\":\\\"1\\\"}\".\r\n      const setResult = await kvClient.set(key, value)\r\n      if (opts?.ex && typeof kvClient.expire === 'function') {\r\n        try {\r\n          await kvClient.expire(key, Math.ceil(opts.ex))\r\n        } catch (_) {\r\n          // ignore\r\n        }\r\n      }\r\n      return setResult\r\n    } catch (err) {\r\n      console.error(\"[KV] set() failed:\", err)\r\n      return null\r\n    }\r\n  },\r\n}\r\n\r\nexport default { kvGetRdap, kvSetRdap }\r\n\r\nexport function getKvStatus() {\r\n  return {\r\n    writeEnabled: WRITE_ENABLED,\r\n    readOnlyOnly: READ_ONLY_ONLY,\r\n    noWriteFallback: NO_WRITE_FALLBACK,\r\n    kvClientPresent: !!kvClient,\r\n    kvUrl: process.env.KV_REST_API_URL || process.env.UPSTASH_REDIS_REST_URL || null,\r\n  }\r\n}\r\n\r\n// Temporary debug helper — writes and reads a test key and logs results.\r\nexport async function debugKvRoundTrip() {\r\n  const key = \"debug:kv:test\"\r\n  const value = { ok: true, ts: Date.now() }\r\n  console.log(\"[KV] Writing test key:\", key)\r\n  const writeResult = await kv.set(key, JSON.stringify(value))\r\n  console.log(\"[KV] Write result:\", writeResult)\r\n  const readResult = await kv.get(key)\r\n  console.log(\"[KV] Read result:\", readResult)\r\n  return { writeResult, readResult }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 442, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/AjaySidal/buildwithai/src/lib/builder/save.ts"],"sourcesContent":["import { kv } from \"@/lib/kv\";\r\nimport type { BuilderState } from \"@/types/builder\";\r\n\r\nconst KEY_PREFIX = \"buildwithai:site:\";\r\n\r\nexport async function saveSiteState(\r\n  siteId: string,\r\n  state: BuilderState\r\n): Promise<void> {\r\n  const key = `${KEY_PREFIX}${siteId}`;\r\n  // Ensure metadata exists\r\n  const metadata = state.metadata ?? {\r\n    id: siteId,\r\n    createdAt: Date.now(),\r\n    updatedAt: Date.now(),\r\n    version: 1,\r\n  };\r\n\r\n  // Increment version + update timestamp\r\n  const nextMetadata = {\r\n    ...metadata,\r\n    updatedAt: Date.now(),\r\n    version: (metadata.version ?? 0) + 1,\r\n  };\r\n\r\n  const payload = JSON.stringify({\r\n    ...state,\r\n    metadata: nextMetadata,\r\n  });\r\n\r\n  await kv.set(key, payload);\r\n}\r\n\r\n// Backwards-compatible adapter expected by templates create route\r\nexport async function saveSite(siteId: string, state: BuilderState) {\r\n  return saveSiteState(siteId, state);\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAGA,MAAM,aAAa;AAEZ,eAAe,cACpB,MAAc,EACd,KAAmB;IAEnB,MAAM,MAAM,GAAG,aAAa,QAAQ;IACpC,yBAAyB;IACzB,MAAM,WAAW,MAAM,QAAQ,IAAI;QACjC,IAAI;QACJ,WAAW,KAAK,GAAG;QACnB,WAAW,KAAK,GAAG;QACnB,SAAS;IACX;IAEA,uCAAuC;IACvC,MAAM,eAAe;QACnB,GAAG,QAAQ;QACX,WAAW,KAAK,GAAG;QACnB,SAAS,CAAC,SAAS,OAAO,IAAI,CAAC,IAAI;IACrC;IAEA,MAAM,UAAU,KAAK,SAAS,CAAC;QAC7B,GAAG,KAAK;QACR,UAAU;IACZ;IAEA,MAAM,uIAAE,CAAC,GAAG,CAAC,KAAK;AACpB;AAGO,eAAe,SAAS,MAAc,EAAE,KAAmB;IAChE,OAAO,cAAc,QAAQ;AAC/B"}},
    {"offset": {"line": 479, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/AjaySidal/buildwithai/src/lib/sites/registry.ts"],"sourcesContent":["import { kv } from \"@/lib/kv\";\r\n\r\nconst SITE_REGISTRY_PREFIX = \"buildwithai:sites\";\r\nconst SITE_REGISTRY_INDEX = \"buildwithai:sites:index\";\r\n\r\nexport type SiteRegistryEntry = {\r\n  id: string;\r\n  name: string;\r\n  createdAt: number;\r\n  updatedAt: number;\r\n};\r\n\r\nexport async function registerSite(id: string, name: string) {\r\n  const key = `${SITE_REGISTRY_PREFIX}:${id}`;\r\n  const existing = await kv.get(key);\r\n\r\n  if (existing) return existing;\r\n\r\n  const entry: SiteRegistryEntry = {\r\n    id,\r\n    name,\r\n    createdAt: Date.now(),\r\n    updatedAt: Date.now(),\r\n  };\r\n\r\n  await kv.set(key, entry);\r\n  // Add to index of sites\r\n  try {\r\n    const idx = (await kv.get(SITE_REGISTRY_INDEX)) as string[] | null;\r\n    const nextIdx = Array.isArray(idx) ? Array.from(new Set([...idx, id])) : [id];\r\n    await kv.set(SITE_REGISTRY_INDEX, nextIdx);\r\n  } catch (e) {\r\n    // ignore index update failures\r\n  }\r\n  return entry;\r\n}\r\n\r\nexport async function updateSiteTimestamp(id: string) {\r\n  const key = `${SITE_REGISTRY_PREFIX}:${id}`;\r\n  const entry = (await kv.get(key)) as SiteRegistryEntry | null;\r\n\r\n  if (!entry) return;\r\n\r\n  entry.updatedAt = Date.now();\r\n  await kv.set(key, entry);\r\n}\r\n\r\nexport async function listSites(): Promise<SiteRegistryEntry[]> {\r\n  const idx = (await kv.get(SITE_REGISTRY_INDEX)) as string[] | null;\r\n  const entries: SiteRegistryEntry[] = [];\r\n\r\n  if (!Array.isArray(idx) || idx.length === 0) return entries;\r\n\r\n  for (const id of idx) {\r\n    const key = `${SITE_REGISTRY_PREFIX}:${id}`;\r\n    const entry = await kv.get(key);\r\n    if (entry) entries.push(entry as SiteRegistryEntry);\r\n  }\r\n\r\n  return entries.sort((a, b) => b.updatedAt - a.updatedAt);\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,MAAM,uBAAuB;AAC7B,MAAM,sBAAsB;AASrB,eAAe,aAAa,EAAU,EAAE,IAAY;IACzD,MAAM,MAAM,GAAG,qBAAqB,CAAC,EAAE,IAAI;IAC3C,MAAM,WAAW,MAAM,uIAAE,CAAC,GAAG,CAAC;IAE9B,IAAI,UAAU,OAAO;IAErB,MAAM,QAA2B;QAC/B;QACA;QACA,WAAW,KAAK,GAAG;QACnB,WAAW,KAAK,GAAG;IACrB;IAEA,MAAM,uIAAE,CAAC,GAAG,CAAC,KAAK;IAClB,wBAAwB;IACxB,IAAI;QACF,MAAM,MAAO,MAAM,uIAAE,CAAC,GAAG,CAAC;QAC1B,MAAM,UAAU,MAAM,OAAO,CAAC,OAAO,MAAM,IAAI,CAAC,IAAI,IAAI;eAAI;YAAK;SAAG,KAAK;YAAC;SAAG;QAC7E,MAAM,uIAAE,CAAC,GAAG,CAAC,qBAAqB;IACpC,EAAE,OAAO,GAAG;IACV,+BAA+B;IACjC;IACA,OAAO;AACT;AAEO,eAAe,oBAAoB,EAAU;IAClD,MAAM,MAAM,GAAG,qBAAqB,CAAC,EAAE,IAAI;IAC3C,MAAM,QAAS,MAAM,uIAAE,CAAC,GAAG,CAAC;IAE5B,IAAI,CAAC,OAAO;IAEZ,MAAM,SAAS,GAAG,KAAK,GAAG;IAC1B,MAAM,uIAAE,CAAC,GAAG,CAAC,KAAK;AACpB;AAEO,eAAe;IACpB,MAAM,MAAO,MAAM,uIAAE,CAAC,GAAG,CAAC;IAC1B,MAAM,UAA+B,EAAE;IAEvC,IAAI,CAAC,MAAM,OAAO,CAAC,QAAQ,IAAI,MAAM,KAAK,GAAG,OAAO;IAEpD,KAAK,MAAM,MAAM,IAAK;QACpB,MAAM,MAAM,GAAG,qBAAqB,CAAC,EAAE,IAAI;QAC3C,MAAM,QAAQ,MAAM,uIAAE,CAAC,GAAG,CAAC;QAC3B,IAAI,OAAO,QAAQ,IAAI,CAAC;IAC1B;IAEA,OAAO,QAAQ,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,SAAS,GAAG,EAAE,SAAS;AACzD"}},
    {"offset": {"line": 539, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/AjaySidal/buildwithai/src/app/api/templates/create/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { getTemplate } from \"@/lib/templates/registry\";\r\nimport landing from \"@/lib/templates/blueprints/landing.json\";\r\nimport portfolio from \"@/lib/templates/blueprints/portfolio.json\";\r\nimport { saveSiteState } from \"../../../../lib/builder/save\";\r\nimport { registerSite } from \"@/lib/sites/registry\";\r\n\r\nconst BLUEPRINTS: Record<string, any> = {\r\n  landing,\r\n  portfolio,\r\n};\r\n\r\nexport async function GET(req: Request) {\r\n  const { searchParams } = new URL(req.url);\r\n  const templateId = searchParams.get(\"templateId\");\r\n\r\n  if (!templateId || !BLUEPRINTS[templateId]) {\r\n    return NextResponse.json(\r\n      { error: \"Invalid templateId\" },\r\n      { status: 400 }\r\n    );\r\n  }\r\n\r\n  const blueprint = BLUEPRINTS[templateId];\r\n\r\n  const siteId = crypto.randomUUID();\r\n\r\n  // Create site metadata first, then persist the initial builder state.\r\n  await registerSite(siteId, `New ${templateId} site`);\r\n\r\n  // Build a minimal BuilderState from the blueprint so it matches\r\n  // the shape expected by `loadSiteState()` (metadata + pages).\r\n  const pageId = crypto.randomUUID();\r\n  const sections = blueprint?.root?.props?.sections ?? [];\r\n  const blocks = Array.isArray(sections)\r\n    ? sections.map((s: any) => ({ id: crypto.randomUUID(), type: s.type ?? \"section\", data: s.props ?? {} }))\r\n    : [];\r\n\r\n  const pages = [\r\n    {\r\n      id: pageId,\r\n      title: blueprint?.root?.props?.title ?? `Page 1`,\r\n      slug: \"home\",\r\n      blocks,\r\n    },\r\n  ];\r\n\r\n  const initialState = {\r\n    metadata: {\r\n      id: siteId,\r\n      name: `New ${templateId} site`,\r\n      createdAt: Date.now(),\r\n      updatedAt: Date.now(),\r\n      version: 1,\r\n    },\r\n    pages,\r\n    activePageId: pageId,\r\n  };\r\n\r\n  await saveSiteState(siteId, initialState);\r\n\r\n  const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || 'http://localhost:3000';\r\n  return NextResponse.redirect(`${baseUrl}/builder/site/${siteId}`);\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AAEA;AACA;AACA;AACA;;;;;;AAEA,MAAM,aAAkC;IACtC,SAAA,kJAAO;IACP,WAAA,oJAAS;AACX;AAEO,eAAe,IAAI,GAAY;IACpC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;IACxC,MAAM,aAAa,aAAa,GAAG,CAAC;IAEpC,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,WAAW,EAAE;QAC1C,OAAO,+JAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAqB,GAC9B;YAAE,QAAQ;QAAI;IAElB;IAEA,MAAM,YAAY,UAAU,CAAC,WAAW;IAExC,MAAM,SAAS,OAAO,UAAU;IAEhC,sEAAsE;IACtE,MAAM,IAAA,gKAAY,EAAC,QAAQ,CAAC,IAAI,EAAE,WAAW,KAAK,CAAC;IAEnD,gEAAgE;IAChE,8DAA8D;IAC9D,MAAM,SAAS,OAAO,UAAU;IAChC,MAAM,WAAW,WAAW,MAAM,OAAO,YAAY,EAAE;IACvD,MAAM,SAAS,MAAM,OAAO,CAAC,YACzB,SAAS,GAAG,CAAC,CAAC,IAAW,CAAC;YAAE,IAAI,OAAO,UAAU;YAAI,MAAM,EAAE,IAAI,IAAI;YAAW,MAAM,EAAE,KAAK,IAAI,CAAC;QAAE,CAAC,KACrG,EAAE;IAEN,MAAM,QAAQ;QACZ;YACE,IAAI;YACJ,OAAO,WAAW,MAAM,OAAO,SAAS,CAAC,MAAM,CAAC;YAChD,MAAM;YACN;QACF;KACD;IAED,MAAM,eAAe;QACnB,UAAU;YACR,IAAI;YACJ,MAAM,CAAC,IAAI,EAAE,WAAW,KAAK,CAAC;YAC9B,WAAW,KAAK,GAAG;YACnB,WAAW,KAAK,GAAG;YACnB,SAAS;QACX;QACA;QACA,cAAc;IAChB;IAEA,MAAM,IAAA,+JAAa,EAAC,QAAQ;IAE5B,MAAM,UAAU,QAAQ,GAAG,CAAC,oBAAoB,IAAI;IACpD,OAAO,+JAAY,CAAC,QAAQ,CAAC,GAAG,QAAQ,cAAc,EAAE,QAAQ;AAClE"}}]
}