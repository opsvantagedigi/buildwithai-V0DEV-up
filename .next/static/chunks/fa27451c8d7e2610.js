(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,49236,e=>{"use strict";var s=e.i(18151),t=e.i(75441);function a(){let[e,a]=(0,t.useState)(null),[r,l]=(0,t.useState)(!1),[n,i]=(0,t.useState)("example.com, openai.com"),[c,o]=(0,t.useState)(null),[d,m]=(0,t.useState)(!1);async function h(){l(!0);try{let e=await fetch("/api/kv/health"),s=await e.json();a(s)}catch(e){a({success:!1,kv:"error",error:"Failed to load health"})}finally{l(!1)}}async function x(){m(!0),o(null);try{let e=n.split(",").map(e=>e.trim()).filter(Boolean),s=await fetch("/api/kv/warm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({domains:e})}),t=await s.json();o(Object.keys(t.results||{}).map(e=>({domain:e,ok:"cached"===t.results[e],error:"string"==typeof t.results[e]&&t.results[e].startsWith("error:")?t.results[e]:void 0})))}catch(e){o([{domain:"unknown",ok:!1,error:"Warm request failed"}])}finally{m(!1)}}return(0,t.useEffect)(()=>{h()},[]),(0,s.jsxs)("main",{className:"mx-auto max-w-3xl px-4 py-10 space-y-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold",children:"KV & RDAP Admin"}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["This admin UI is protected — include ",(0,s.jsx)("code",{children:"?token=YOUR_TOKEN"})," in the URL or set an ",(0,s.jsx)("code",{children:"x-admin-token"})," header. Set ",(0,s.jsx)("code",{children:"ADMIN_DASHBOARD_TOKEN"})," in your deployment environment."]}),(0,s.jsxs)("section",{className:"rounded-lg border p-4 bg-white space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"font-semibold",children:"KV Health"}),(0,s.jsx)("button",{onClick:h,disabled:r,className:"text-sm px-3 py-1 rounded bg-gray-900 text-white disabled:opacity-50",children:r?"Checking...":"Refresh"})]}),e&&(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Status:"})," ",e.success?"Healthy":"Unhealthy"," (",e.kv,")"]}),e.ts&&(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Last check:"})," ",new Date(e.ts).toLocaleString()]}),e.error&&(0,s.jsxs)("p",{className:"text-red-600 text-xs mt-1",children:["Error: ",e.error]})]}),!e&&!r&&(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"No health data loaded yet."})]}),(0,s.jsxs)("section",{className:"rounded-lg border p-4 bg-white space-y-3",children:[(0,s.jsx)("h2",{className:"font-semibold",children:"Warm KV with domains"}),(0,s.jsx)("p",{className:"text-xs text-gray-600",children:"Enter a comma‑separated list of domains to pre‑fetch RDAP + KV."}),(0,s.jsx)("textarea",{className:"w-full border rounded p-2 text-sm",rows:3,value:n,onChange:e=>i(e.target.value)}),(0,s.jsx)("button",{onClick:x,disabled:d,className:"text-sm px-3 py-1 rounded bg-blue-600 text-white disabled:opacity-50",children:d?"Warming...":"Run warm job"}),c&&(0,s.jsxs)("div",{className:"mt-3 text-sm",children:[(0,s.jsx)("h3",{className:"font-medium mb-1",children:"Results"}),(0,s.jsx)("ul",{className:"space-y-1",children:c.map((e,t)=>(0,s.jsxs)("li",{children:[(0,s.jsx)("span",{className:"font-mono",children:e.domain})," ",e.ok?(0,s.jsx)("span",{className:"text-green-700 text-xs",children:"OK"}):(0,s.jsxs)("span",{className:"text-red-700 text-xs",children:["FAILED ",e.error?`- ${e.error}`:""]})]},t))})]})]})]})}e.s(["default",()=>a])}]);